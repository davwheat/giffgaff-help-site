function trim(e){return e.replace(/^\s+|\s+$/g,"")}function removeSpace(e){return e.replace(/\s/g,"")}function getCurrentDate(){var e=new Date,t=e.getDate(),n=e.getMonth()+1;return t<10&&(t="0"+t),n<10&&(n="0"+n),e=n+"/"+t+"/"+e.getFullYear()}function getDateDifference(e,t){e=new Date(e),t=new Date(t);var n=Math.abs(t.getTime()-e.getTime());return Math.ceil(n/864e5)}function getTimeDifference(e,t){var n=new Date(e),a=new Date(t),r=n.getTime();return a.getTime()<r?30:14}function isValidTransferDate(e){var t=getTimeDifference(getCurrentDate(),e);return 30==t?isAllowedTransferDate(t,e):14!=t||isAllowedTransferDate(t,e)}function isAllowedTransferDate(e,t){return!(e<getDateDifference(getCurrentDate(),t))}function addToDataLayerTracking(e){window.dataLayer.push({eventCategory:"Errors",eventAction:"Field",eventLabel:e,event:"customEvent"})}jQuery.easing.jswing=jQuery.easing.swing,jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(e,t,n,a,r){return jQuery.easing[jQuery.easing.def](e,t,n,a,r)},easeInQuad:function(e,t,n,a,r){return a*(t/=r)*t+n},easeOutQuad:function(e,t,n,a,r){return-a*(t/=r)*(t-2)+n},easeInOutQuad:function(e,t,n,a,r){return(t/=r/2)<1?a/2*t*t+n:-a/2*(--t*(t-2)-1)+n},easeInCubic:function(e,t,n,a,r){return a*(t/=r)*t*t+n},easeOutCubic:function(e,t,n,a,r){return a*((t=t/r-1)*t*t+1)+n},easeInOutCubic:function(e,t,n,a,r){return(t/=r/2)<1?a/2*t*t*t+n:a/2*((t-=2)*t*t+2)+n},easeInQuart:function(e,t,n,a,r){return a*(t/=r)*t*t*t+n},easeOutQuart:function(e,t,n,a,r){return-a*((t=t/r-1)*t*t*t-1)+n},easeInOutQuart:function(e,t,n,a,r){return(t/=r/2)<1?a/2*t*t*t*t+n:-a/2*((t-=2)*t*t*t-2)+n},easeInQuint:function(e,t,n,a,r){return a*(t/=r)*t*t*t*t+n},easeOutQuint:function(e,t,n,a,r){return a*((t=t/r-1)*t*t*t*t+1)+n},easeInOutQuint:function(e,t,n,a,r){return(t/=r/2)<1?a/2*t*t*t*t*t+n:a/2*((t-=2)*t*t*t*t+2)+n},easeInSine:function(e,t,n,a,r){return-a*Math.cos(t/r*(Math.PI/2))+a+n},easeOutSine:function(e,t,n,a,r){return a*Math.sin(t/r*(Math.PI/2))+n},easeInOutSine:function(e,t,n,a,r){return-a/2*(Math.cos(Math.PI*t/r)-1)+n},easeInExpo:function(e,t,n,a,r){return 0==t?n:a*Math.pow(2,10*(t/r-1))+n},easeOutExpo:function(e,t,n,a,r){return t==r?n+a:a*(1-Math.pow(2,-10*t/r))+n},easeInOutExpo:function(e,t,n,a,r){return 0==t?n:t==r?n+a:(t/=r/2)<1?a/2*Math.pow(2,10*(t-1))+n:a/2*(2-Math.pow(2,-10*--t))+n},easeInCirc:function(e,t,n,a,r){return-a*(Math.sqrt(1-(t/=r)*t)-1)+n},easeOutCirc:function(e,t,n,a,r){return a*Math.sqrt(1-(t=t/r-1)*t)+n},easeInOutCirc:function(e,t,n,a,r){return(t/=r/2)<1?-a/2*(Math.sqrt(1-t*t)-1)+n:a/2*(Math.sqrt(1-(t-=2)*t)+1)+n},easeInElastic:function(e,t,n,a,r){var i=1.70158,o=0,s=a;if(0==t)return n;if(1==(t/=r))return n+a;if(o||(o=.3*r),s<Math.abs(a)){s=a;i=o/4}else i=o/(2*Math.PI)*Math.asin(a/s);return-s*Math.pow(2,10*(t-=1))*Math.sin((t*r-i)*(2*Math.PI)/o)+n},easeOutElastic:function(e,t,n,a,r){var i=1.70158,o=0,s=a;if(0==t)return n;if(1==(t/=r))return n+a;if(o||(o=.3*r),s<Math.abs(a)){s=a;i=o/4}else i=o/(2*Math.PI)*Math.asin(a/s);return s*Math.pow(2,-10*t)*Math.sin((t*r-i)*(2*Math.PI)/o)+a+n},easeInOutElastic:function(e,t,n,a,r){var i=1.70158,o=0,s=a;if(0==t)return n;if(2==(t/=r/2))return n+a;if(o||(o=r*(.3*1.5)),s<Math.abs(a)){s=a;i=o/4}else i=o/(2*Math.PI)*Math.asin(a/s);return t<1?s*Math.pow(2,10*(t-=1))*Math.sin((t*r-i)*(2*Math.PI)/o)*-.5+n:s*Math.pow(2,-10*(t-=1))*Math.sin((t*r-i)*(2*Math.PI)/o)*.5+a+n},easeInBack:function(e,t,n,a,r,i){return null==i&&(i=1.70158),a*(t/=r)*t*((i+1)*t-i)+n},easeOutBack:function(e,t,n,a,r,i){return null==i&&(i=1.70158),a*((t=t/r-1)*t*((i+1)*t+i)+1)+n},easeInOutBack:function(e,t,n,a,r,i){return null==i&&(i=1.70158),(t/=r/2)<1?a/2*(t*t*((1+(i*=1.525))*t-i))+n:a/2*((t-=2)*t*((1+(i*=1.525))*t+i)+2)+n},easeInBounce:function(e,t,n,a,r){return a-jQuery.easing.easeOutBounce(e,r-t,0,a,r)+n},easeOutBounce:function(e,t,n,a,r){return(t/=r)<1/2.75?a*(7.5625*t*t)+n:t<2/2.75?a*(7.5625*(t-=1.5/2.75)*t+.75)+n:t<2.5/2.75?a*(7.5625*(t-=2.25/2.75)*t+.9375)+n:a*(7.5625*(t-=2.625/2.75)*t+.984375)+n},easeInOutBounce:function(e,t,n,a,r){return t<r/2?.5*jQuery.easing.easeInBounce(e,2*t,0,a,r)+n:.5*jQuery.easing.easeOutBounce(e,2*t-r,0,a,r)+.5*a+n}}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(window.jQuery||window.Zepto)}(function(l){var r=function(i,p,f){var a,t,v=this;i=l(i),p="function"==typeof p?p(i.val(),void 0,i,f):p;var y={getCaret:function(){try{var e,t=0,n=i.get(0),a=document.selection,r=n.selectionStart;return a&&!~navigator.appVersion.indexOf("MSIE 10")?((e=a.createRange()).moveStart("character",i.is("input")?-i.val().length:-i.text().length),t=e.text.length):(r||"0"===r)&&(t=r),t}catch(e){}},setCaret:function(e){try{if(i.is(":focus")){var t,n=i.get(0);n.setSelectionRange?n.setSelectionRange(e,e):n.createTextRange&&((t=n.createTextRange()).collapse(!0),t.moveEnd("character",e),t.moveStart("character",e),t.select())}}catch(e){}},events:function(){i.on("keydown.mask",function(){a=y.val()}).on("keyup.mask",y.behaviour).on("paste.mask drop.mask",function(){setTimeout(function(){i.keydown().keyup()},100)}).on("change.mask",function(){i.data("changed",!0)}).on("blur.mask",function(){a===i.val()||i.data("changed")||i.trigger("change"),i.data("changed",!1)}).on("focusout.mask",function(){f.clearIfNotMatch&&!t.test(y.val())&&y.val("")})},getRegexMask:function(){for(var e,t,n,a,r=[],i=0;i<p.length;i++)(e=v.translation[p[i]])?(t=e.pattern.toString().replace(/.{1}$|^.{1}/g,""),n=e.optional,(e=e.recursive)?(r.push(p[i]),a={digit:p[i],pattern:t}):r.push(n||e?t+"?":t)):r.push(p[i].replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"));return r=r.join(""),a&&(r=r.replace(new RegExp("("+a.digit+"(.*"+a.digit+")?)"),"($1)?").replace(new RegExp(a.digit,"g"),a.pattern)),new RegExp(r)},destroyEvents:function(){i.off("keydown keyup paste drop change blur focusout DOMNodeInserted ".split(" ").join(".mask ")).removeData("changeCalled")},val:function(e){var t=i.is("input");return 0<arguments.length?t?i.val(e):i.text(e):t?i.val():i.text()},getMCharsBeforeCount:function(e,t){for(var n=0,a=0,r=p.length;a<r&&a<e;a++)v.translation[p.charAt(a)]||(e=t?e+1:e,n++);return n},caretPos:function(e,t,n,a){return v.translation[p.charAt(Math.min(e-1,p.length-1))]?Math.min(e+n-t-a,n):y.caretPos(e+1,t,n,a)},behaviour:function(e){var t=(e=e||window.event).keyCode||e.which;if(-1===l.inArray(t,v.byPassKeys)){var n=y.getCaret(),a=y.val(),r=a.length,i=n<r,o=y.getMasked(),s=o.length,d=y.getMCharsBeforeCount(s-1)-y.getMCharsBeforeCount(r-1);return o!==a&&y.val(o),!i||65===t&&e.ctrlKey||(8!==t&&46!==t&&(n=y.caretPos(n,r,s,d)),y.setCaret(n)),y.callbacks(e)}},getMasked:function(e){var t,n,a=[],r=y.val(),i=0,o=p.length,s=0,d=r.length,l=1,c="push",u=-1;for(f.reverse?(c="unshift",l=-1,t=0,i=o-1,s=d-1,n=function(){return-1<i&&-1<s}):(t=o-1,n=function(){return i<o&&s<d});n();){var g=p.charAt(i),h=r.charAt(s),m=v.translation[g];m?(h.match(m.pattern)?(a[c](h),m.recursive&&(-1===u?u=i:i===t&&(i=u-l),t===u&&(i-=l)),i+=l):m.optional&&(i+=l,s-=l),s+=l):(e||a[c](g),h===g&&(s+=l),i+=l)}return e=p.charAt(t),o!==d+1||v.translation[e]||a.push(e),a.join("")},callbacks:function(e){var t=y.val(),n=t!==a;!0===n&&"function"==typeof f.onChange&&f.onChange(t,e,i,f),!0===n&&"function"==typeof f.onKeyPress&&f.onKeyPress(t,e,i,f),"function"==typeof f.onComplete&&t.length===p.length&&f.onComplete(t,e,i,f)}};v.mask=p,v.options=f,v.remove=function(){var e;return y.destroyEvents(),y.val(v.getCleanVal()).removeAttr("maxlength"),e=y.getCaret(),y.setCaret(e-y.getMCharsBeforeCount(e)),i},v.getCleanVal=function(){return y.getMasked(!0)},v.init=function(){f=f||{},v.byPassKeys=[9,16,17,18,36,37,38,39,40,91],v.translation={0:{pattern:/\d/},9:{pattern:/\d/,optional:!0},"#":{pattern:/\d/,recursive:!0},A:{pattern:/[a-zA-Z0-9]/},S:{pattern:/[a-zA-Z]/}},v.translation=l.extend({},v.translation,f.translation),v=l.extend(!0,{},v,f),t=y.getRegexMask(),!1!==f.maxlength&&i.attr("maxlength",p.length),f.placeholder&&i.attr("placeholder",f.placeholder),i.attr("autocomplete","off"),y.destroyEvents(),y.events();var e=y.getCaret();y.val(y.getMasked()),y.setCaret(e+y.getMCharsBeforeCount(e,!0))}()},i={},e=function(){var e=l(this),t={};e.attr("data-mask-reverse")&&(t.reverse=!0),"false"===e.attr("data-mask-maxlength")&&(t.maxlength=!1),e.attr("data-mask-clearifnotmatch")&&(t.clearIfNotMatch=!0),e.mask(e.attr("data-mask"),t)};l.fn.mask=function(n,a){var e=this.selector,t=function(){var e=l(this).data("mask"),t=JSON.stringify;if("object"!=typeof e||t(e.options)!==t(a)||e.mask!==n)return l(this).data("mask",new r(this,n,a))};this.each(t),e&&!i[e]&&(i[e]=!0,setTimeout(function(){l(document).on("DOMNodeInserted.mask",e,t)},500))},l.fn.unmask=function(){try{return this.each(function(){l(this).data("mask").remove().removeData("mask")})}catch(e){}},l.fn.cleanVal=function(){return this.data("mask").getCleanVal()},l("*[data-mask]").each(e),l(document).on("DOMNodeInserted.mask","*[data-mask]",e)}),function(l){l.extend(l.fn,{validate:function(e){if(this.length){var n=l.data(this[0],"validator");if(n)return n;if(this.attr("novalidate","novalidate"),n=new l.validator(e,this[0]),l.data(this[0],"validator",n),n.settings.onsubmit){var t=this.find("input, button");t.filter(".cancel").click(function(){n.cancelSubmit=!0}),n.settings.submitHandler&&t.filter(":submit").click(function(){n.submitButton=this}),this.submit(function(e){function t(){if(n.settings.submitHandler){if(n.submitButton)var e=l("<input type='hidden'/>").attr("name",n.submitButton.name).val(n.submitButton.value).appendTo(n.currentForm);return n.settings.submitHandler.call(n,n.currentForm),n.submitButton&&e.remove(),!1}return!0}return n.settings.debug&&e.preventDefault(),n.cancelSubmit?(n.cancelSubmit=!1,t()):n.form()?n.pendingRequest?!(n.formSubmitted=!0):t():(n.focusInvalid(),!1)})}return n}e&&e.debug&&window.console&&console.warn("nothing selected, can't validate, returning nothing")},valid:function(){if(l(this[0]).is("form"))return this.validate().form();var e=!0,t=l(this[0].form).validate();return this.each(function(){e&=t.element(this)}),e},removeAttrs:function(e){var n={},a=this;return l.each(e.split(/\s/),function(e,t){n[t]=a.attr(t),a.removeAttr(t)}),n},rules:function(e,t){var n=this[0];if(e){var a=l.data(n.form,"validator").settings,r=a.rules,i=l.validator.staticRules(n);switch(e){case"add":l.extend(i,l.validator.normalizeRule(t)),r[n.name]=i,t.messages&&(a.messages[n.name]=l.extend(a.messages[n.name],t.messages));break;case"remove":if(!t)return delete r[n.name],i;var o={};return l.each(t.split(/\s/),function(e,t){o[t]=i[t],delete i[t]}),o}}var s=l.validator.normalizeRules(l.extend({},l.validator.metadataRules(n),l.validator.classRules(n),l.validator.attributeRules(n),l.validator.staticRules(n)),n);if(s.required){var d=s.required;delete s.required,s=l.extend({required:d},s)}return s}}),l.extend(l.expr[":"],{blank:function(e){return!l.trim(""+e.value)},filled:function(e){return!!l.trim(""+e.value)},unchecked:function(e){return!e.checked}}),l.validator=function(e,t){this.settings=l.extend(!0,{},l.validator.defaults,e),this.currentForm=t,this.init()},l.validator.format=function(n,e){return 1==arguments.length?function(){var e=l.makeArray(arguments);return e.unshift(n),l.validator.format.apply(this,e)}:(2<arguments.length&&e.constructor!=Array&&(e=l.makeArray(arguments).slice(1)),e.constructor!=Array&&(e=[e]),l.each(e,function(e,t){n=n.replace(new RegExp("\\{"+e+"\\}","g"),t)}),n)},l.extend(l.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:!0,errorContainer:l([]),errorLabelContainer:l([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(e,t){this.lastActive=e,this.settings.focusCleanup&&!this.blockFocusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,e,this.settings.errorClass,this.settings.validClass),this.addWrapper(this.errorsFor(e)).hide())},onfocusout:function(e,t){this.checkable(e)||!(e.name in this.submitted)&&this.optional(e)||this.element(e)},onkeyup:function(e,t){(e.name in this.submitted||e==this.lastElement)&&this.element(e)},onclick:function(e,t){e.name in this.submitted?this.element(e):e.parentNode.name in this.submitted&&this.element(e.parentNode)},highlight:function(e,t,n){"radio"===e.type?this.findByName(e.name).addClass(t).removeClass(n):l(e).addClass(t).removeClass(n)},unhighlight:function(e,t,n){"radio"===e.type?this.findByName(e.name).removeClass(t).addClass(n):l(e).removeClass(t).addClass(n)}},setDefaults:function(e){l.extend(l.validator.defaults,e)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:l.validator.format("Please enter no more than {0} characters."),minlength:l.validator.format("Please enter at least {0} characters."),rangelength:l.validator.format("Please enter a value between {0} and {1} characters long."),range:l.validator.format("Please enter a value between {0} and {1}."),max:l.validator.format("Please enter a value less than or equal to {0}."),min:l.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:!1,prototype:{init:function(){this.labelContainer=l(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||l(this.currentForm),this.containers=l(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset();var a=this.groups={};l.each(this.settings.groups,function(n,e){l.each(e.split(/\s/),function(e,t){a[t]=n})});var n=this.settings.rules;function e(e){var t=l.data(this[0].form,"validator"),n="on"+e.type.replace(/^validate/,"");t.settings[n]&&t.settings[n].call(t,this[0],e)}l.each(n,function(e,t){n[e]=l.validator.normalizeRule(t)}),l(this.currentForm).validateDelegate("[type='text'], [type='password'], [type='file'], select, textarea, [type='number'], [type='search'] ,[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'] ","focusin focusout keyup",e).validateDelegate("[type='radio'], [type='checkbox'], select, option","click",e),this.settings.invalidHandler&&l(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)},form:function(){return this.checkForm(),l.extend(this.submitted,this.errorMap),this.invalid=l.extend({},this.errorMap),this.valid()||l(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var e=0,t=this.currentElements=this.elements();t[e];e++)this.check(t[e]);return this.valid()},element:function(e){e=this.validationTargetFor(this.clean(e)),this.lastElement=e,this.prepareElement(e),this.currentElements=l(e);var t=this.check(e);return t?delete this.invalid[e.name]:this.invalid[e.name]=!0,this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),t},showErrors:function(t){if(t){for(var e in l.extend(this.errorMap,t),this.errorList=[],t)this.errorList.push({message:t[e],element:this.findByName(e)[0]});this.successList=l.grep(this.successList,function(e){return!(e.name in t)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){l.fn.resetForm&&l(this.currentForm).resetForm(),this.submitted={},this.lastElement=null,this.prepareForm(),this.hideErrors(),this.elements().removeClass(this.settings.errorClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(e){var t=0;for(var n in e)t++;return t},hideErrors:function(){this.addWrapper(this.toHide).hide()},valid:function(){return 0==this.size()},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{l(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(e){}},findLastActive:function(){var t=this.lastActive;return t&&1==l.grep(this.errorList,function(e){return e.element.name==t.name}).length&&t},elements:function(){var e=this,t={};return l(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){return!this.name&&e.settings.debug&&window.console&&console.error("%o has no name assigned",this),!(this.name in t||!e.objectLength(l(this).rules()))&&(t[this.name]=!0)})},clean:function(e){return l(e)[0]},errors:function(){return l(this.settings.errorElement+"."+this.settings.errorClass,this.errorContext)},reset:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=l([]),this.toHide=l([]),this.currentElements=l([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(e){this.reset(),this.toHide=this.errorsFor(e)},check:function(t){t=this.validationTargetFor(this.clean(t));var e=l(t).rules(),n=!1;for(var a in e){var r={method:a,parameters:e[a]};try{var i=l.validator.methods[a].call(this,t.value.replace(/\r/g,""),t,r.parameters);if("dependency-mismatch"==i){n=!0;continue}if(n=!1,"pending"==i)return void(this.toHide=this.toHide.not(this.errorsFor(t)));if(!i)return this.formatAndAdd(t,r),!1}catch(e){throw this.settings.debug&&window.console&&console.log("exception occured when checking element "+t.id+", check the '"+r.method+"' method",e),e}}if(!n)return this.objectLength(e)&&this.successList.push(t),!0},customMetaMessage:function(e,t){if(l.metadata){var n=this.settings.meta?l(e).metadata()[this.settings.meta]:l(e).metadata();return n&&n.messages&&n.messages[t]}},customMessage:function(e,t){var n=this.settings.messages[e];return n&&(n.constructor==String?n:n[t])},findDefined:function(){for(var e=0;e<arguments.length;e++)if(void 0!==arguments[e])return arguments[e]},defaultMessage:function(e,t){return this.findDefined(this.customMessage(e.name,t),this.customMetaMessage(e,t),!this.settings.ignoreTitle&&e.title||void 0,l.validator.messages[t],"<strong>Warning: No message defined for "+e.name+"</strong>")},formatAndAdd:function(e,t){var n=this.defaultMessage(e,t.method),a=/\$?\{(\d+)\}/g;"function"==typeof n?n=n.call(this,t.parameters,e):a.test(n)&&(n=jQuery.format(n.replace(a,"{$1}"),t.parameters)),this.errorList.push({message:n,element:e}),this.errorMap[e.name]=n,this.submitted[e.name]=n},addWrapper:function(e){return this.settings.wrapper&&(e=e.add(e.parent(this.settings.wrapper))),e},defaultShowErrors:function(){for(var e=0;this.errorList[e];e++){var t=this.errorList[e];this.settings.highlight&&this.settings.highlight.call(this,t.element,this.settings.errorClass,this.settings.validClass),this.showLabel(t.element,t.message)}if(this.errorList.length&&(this.toShow=this.toShow.add(this.containers)),this.settings.success)for(e=0;this.successList[e];e++)this.showLabel(this.successList[e]);if(this.settings.unhighlight){e=0;for(var n=this.validElements();n[e];e++)this.settings.unhighlight.call(this,n[e],this.settings.errorClass,this.settings.validClass)}this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return l(this.errorList).map(function(){return this.element})},showLabel:function(e,t){var n=this.errorsFor(e);n.length?(n.removeClass(this.settings.validClass).addClass(this.settings.errorClass),n.attr("generated")&&n.html(t)):(n=l("<"+this.settings.errorElement+"/>").attr({for:this.idOrName(e),generated:!0}).addClass(this.settings.errorClass).html(t||""),this.settings.wrapper&&(n=n.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.append(n).length||(this.settings.errorPlacement?this.settings.errorPlacement(n,l(e)):n.insertAfter(e))),!t&&this.settings.success&&(n.text(""),"string"==typeof this.settings.success?n.addClass(this.settings.success):this.settings.success(n)),this.toShow=this.toShow.add(n)},errorsFor:function(e){var t=this.idOrName(e);return this.errors().filter(function(){return l(this).attr("for")==t})},idOrName:function(e){return this.groups[e.name]||(this.checkable(e)?e.name:e.id||e.name)},validationTargetFor:function(e){return this.checkable(e)&&(e=this.findByName(e.name).not(this.settings.ignore)[0]),e},checkable:function(e){return/radio|checkbox/i.test(e.type)},findByName:function(n){var a=this.currentForm;return l(document.getElementsByName(n)).map(function(e,t){return t.form==a&&t.name==n&&t||null})},getLength:function(e,t){switch(t.nodeName.toLowerCase()){case"select":return l("option:selected",t).length;case"input":if(this.checkable(t))return this.findByName(t.name).filter(":checked").length}return e.length},depend:function(e,t){return!this.dependTypes[typeof e]||this.dependTypes[typeof e](e,t)},dependTypes:{boolean:function(e,t){return e},string:function(e,t){return!!l(e,t.form).length},function:function(e,t){return e(t)}},optional:function(e){return!l.validator.methods.required.call(this,l.trim(e.value),e)&&"dependency-mismatch"},startRequest:function(e){this.pending[e.name]||(this.pendingRequest++,this.pending[e.name]=!0)},stopRequest:function(e,t){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[e.name],t&&0==this.pendingRequest&&this.formSubmitted&&this.form()?(l(this.currentForm).submit(),this.formSubmitted=!1):!t&&0==this.pendingRequest&&this.formSubmitted&&(l(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(e){return l.data(e,"previousValue")||l.data(e,"previousValue",{old:null,valid:!0,message:this.defaultMessage(e,"remote")})}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},dateDE:{dateDE:!0},number:{number:!0},numberDE:{numberDE:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(e,t){e.constructor==String?this.classRuleSettings[e]=t:l.extend(this.classRuleSettings,e)},classRules:function(e){var t={},n=l(e).attr("class");return n&&l.each(n.split(" "),function(){this in l.validator.classRuleSettings&&l.extend(t,l.validator.classRuleSettings[this])}),t},attributeRules:function(e){var t={},n=l(e);for(var a in l.validator.methods){var r;(r="required"===a&&"function"==typeof l.fn.prop?n.prop(a):n.attr(a))?t[a]=r:n[0].getAttribute("type")===a&&(t[a]=!0)}return t.maxlength&&/-1|2147483647|524288/.test(t.maxlength)&&delete t.maxlength,t},metadataRules:function(e){if(!l.metadata)return{};var t=l.data(e.form,"validator").settings.meta;return t?l(e).metadata()[t]:l(e).metadata()},staticRules:function(e){var t={},n=l.data(e.form,"validator");return n.settings.rules&&(t=l.validator.normalizeRule(n.settings.rules[e.name])||{}),t},normalizeRules:function(a,r){return l.each(a,function(e,t){if(!1!==t){if(t.param||t.depends){var n=!0;switch(typeof t.depends){case"string":n=!!l(t.depends,r.form).length;break;case"function":n=t.depends.call(r,r)}n?a[e]=void 0===t.param||t.param:delete a[e]}}else delete a[e]}),l.each(a,function(e,t){a[e]=l.isFunction(t)?t(r):t}),l.each(["minlength","maxlength","min","max"],function(){a[this]&&(a[this]=Number(a[this]))}),l.each(["rangelength","range"],function(){a[this]&&(a[this]=[Number(a[this][0]),Number(a[this][1])])}),l.validator.autoCreateRanges&&(a.min&&a.max&&(a.range=[a.min,a.max],delete a.min,delete a.max),a.minlength&&a.maxlength&&(a.rangelength=[a.minlength,a.maxlength],delete a.minlength,delete a.maxlength)),a.messages&&delete a.messages,a},normalizeRule:function(e){if("string"==typeof e){var t={};l.each(e.split(/\s/),function(){t[this]=!0}),e=t}return e},addMethod:function(e,t,n){l.validator.methods[e]=t,l.validator.messages[e]=null!=n?n:l.validator.messages[e],t.length<3&&l.validator.addClassRules(e,l.validator.normalizeRule(e))},methods:{required:function(e,t,n){if(!this.depend(n,t))return"dependency-mismatch";switch(t.nodeName.toLowerCase()){case"select":var a=l(t).val();return a&&0<a.length;case"input":if(this.checkable(t))return 0<this.getLength(e,t);default:return 0<l.trim(e).length}},remote:function(i,o,e){if(this.optional(o))return"dependency-mismatch";var s=this.previousValue(o);if(this.settings.messages[o.name]||(this.settings.messages[o.name]={}),s.originalMessage=this.settings.messages[o.name].remote,this.settings.messages[o.name].remote=s.message,e="string"==typeof e&&{url:e}||e,this.pending[o.name])return"pending";if(s.old===i)return s.valid;s.old=i;var d=this;this.startRequest(o);var t={};return t[o.name]=i,l.ajax(l.extend(!0,{url:e,mode:"abort",port:"validate"+o.name,dataType:"json",data:t,success:function(e){d.settings.messages[o.name].remote=s.originalMessage;var t=!0===e;if(t){var n=d.formSubmitted;d.prepareElement(o),d.formSubmitted=n,d.successList.push(o),d.showErrors()}else{var a={},r=e||d.defaultMessage(o,"remote");a[o.name]=s.message=l.isFunction(r)?r(i):r,d.showErrors(a)}s.valid=t,d.stopRequest(o,t)}},e)),"pending"},minlength:function(e,t,n){return this.optional(t)||this.getLength(l.trim(e),t)>=n},maxlength:function(e,t,n){return this.optional(t)||this.getLength(l.trim(e),t)<=n},rangelength:function(e,t,n){var a=this.getLength(l.trim(e),t);return this.optional(t)||a>=n[0]&&a<=n[1]},min:function(e,t,n){return this.optional(t)||n<=e},max:function(e,t,n){return this.optional(t)||e<=n},range:function(e,t,n){return this.optional(t)||e>=n[0]&&e<=n[1]},email:function(e,t){return this.optional(t)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(e)},url:function(e,t){return this.optional(t)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)},date:function(e,t){return this.optional(t)||!/Invalid|NaN/.test(new Date(e))},dateISO:function(e,t){return this.optional(t)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(e)},number:function(e,t){return this.optional(t)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(e)},digits:function(e,t){return this.optional(t)||/^\d+$/.test(e)},creditcard:function(e,t){if(this.optional(t))return"dependency-mismatch";if(/[^0-9 -]+/.test(e))return!1;for(var n=0,a=0,r=!1,i=(e=e.replace(/\D/g,"")).length-1;0<=i;i--){var o=e.charAt(i);a=parseInt(o,10);r&&9<(a*=2)&&(a-=9),n+=a,r=!r}return n%10==0},accept:function(e,t,n){return n="string"==typeof n?n.replace(/,/g,"|"):"png|jpe?g|gif",this.optional(t)||e.match(new RegExp(".("+n+")$","i"))},equalTo:function(e,t,n){return e==l(n).unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){l(t).valid()}).val()}}}),l.format=l.validator.format}(jQuery),function(a){var r={};if(a.ajaxPrefilter)a.ajaxPrefilter(function(e,t,n){var a=e.port;"abort"==e.mode&&(r[a]&&r[a].abort(),r[a]=n)});else{var i=a.ajax;a.ajax=function(e){var t=("mode"in e?e:a.ajaxSettings).mode,n=("port"in e?e:a.ajaxSettings).port;return"abort"==t?(r[n]&&r[n].abort(),r[n]=i.apply(this,arguments)):i.apply(this,arguments)}}}(jQuery),function(r){jQuery.event.special.focusin||jQuery.event.special.focusout||!document.addEventListener||r.each({focus:"focusin",blur:"focusout"},function(e,t){function n(e){return(e=r.event.fix(e)).type=t,r.event.handle.call(this,e)}r.event.special[t]={setup:function(){this.addEventListener(e,n,!0)},teardown:function(){this.removeEventListener(e,n,!0)},handler:function(e){return arguments[0]=r.event.fix(e),e.type=t,r.event.handle.apply(this,arguments)}}}),r.extend(r.fn,{validateDelegate:function(n,e,a){return this.bind(e,function(e){var t=r(e.target);if(t.is(n))return a.apply(t,arguments)})}})}(jQuery),$.validator&&($.validator.setDefaults({ignore:[],onkeyup:!1,errorClass:"error",errorElement:"span",unhighlight:function(e,t,n){$(e).removeClass(t).addClass(n),$(e).siblings("span.error").remove(),$(e).siblings().removeClass(t).addClass(n)},highlight:function(e,t,n){$(e).addClass(t).removeClass(n)},errorPlacement:function(e,t){if(t.parent().children("span[class=error]").remove(),"radio"==t.attr("type")||"checkbox"==t.attr("type")?e.insertAfter(t.closest(".controls").children().last()):t.hasClass("country-dropdown")?e.insertAfter(t.parent().addClass("error")):t.parent().children("span[class=help-block]").length?e.insertAfter(t.parent().children("span[class=help-block]")):t.parent().children(".multiple-field")?e.insertAfter(t.parent().children().last()):t.parent().children("p[class=desc]").length?e.insertAfter(t.parent().children("p[class=desc]")):t.parent().children("a[class=*modal-help]").length?e.insertAfter(t.parent().children("a[class=*modal-help]")):e.insertAfter(t),$(t).hasClass("paf_hide")||$(t).hasClass("paf_hide_exc")){var n=!0;void 0!==t.parents("form").data("paf-manual-allowed")&&(n=t.parents("form").data("paf-manual-allowed")),n?t.parents(".address").find(".paf_hide").parents(".control-group").removeClass("hide"):t.parents(".address").find(".paf-error").html('<i class="icon-15x15-warning pull-left"></i>Please click Find address and select yours').removeClass("hide")}$(".saved-address").hide(),$(".address-group").show()},createSpinner:function(e){var t=$(e).find("input[type=submit]:visible");t.addClass("hide"),$(e).find(" .submit-loading").removeClass("hide").html('<i class="icon-15x15-loading"></i>'+t.val()),spinner()},submitHandler:function(e){$(e).hasClass("confirm-form")||(this.settings.createSpinner(e),e.submit())}}),$.extend($.validator.messages,{required:"Required field",email:"That's not a valid email"}),$.validator.addMethod("yes-no-required",function(e,t){return 0<$("input[name="+$(t).attr("name")+"]:checked").length},'Please pick either "yes" or "no"'),$.validator.addMethod("date",function(e,t){var n=formatDate(e);return null!=Date.parse(n)&&(val=this.optional(t)||/^\d{1,2}[\/]\d{1,2}[\/]\d{4}$/.test(e)||/^\d{4}[-]\d{1,2}[-]\d{1,2}$/.test(e),!!val||!($.validator.messages.date="Please enter the date in DD/MM/YYYY format"))},"That's not a valid date"),$.validator.addMethod("datetime",function(e,t){var n=stripDate(e),a=formatDate(e);return null!=Date.parse(a)&&(val=this.optional(t)||/^\d{1,2}[\/]\d{1,2}[\/]\d{4}[ ]\d{2}[:]\d{2}$/.test(n)||/^\d{4}[-]\d{1,2}[-]\d{1,2}$/.test(e)||/^\d{4}[-]\d{1,2}[-]\d{1,2}[ ]\d{2}[:]\d{2}$/.test(n),!!val||!($.validator.messages.datetime="Please enter the date in DD/MM/YYYY 00:00 format"))},"That's not a valid date"),$.validator.addMethod("datetime-local",function(e,t){var n=stripDate(e),a=formatDate(e);return null!=Date.parse(a)&&(val=this.optional(t)||/^\d{1,2}[\/]\d{1,2}[\/]\d{4}[ ]\d{2}[:]\d{2}[:]\d{2}$/.test(n)||/^\d{1,2}[\/]\d{1,2}[\/]\d{4}[ ]\d{2}[:]\d{2}$/.test(n)||/^\d{4}[-]\d{1,2}[-]\d{1,2}[ ]\d{2}[:]\d{2}$/.test(n)||/^\d{4}[-]\d{1,2}[-]\d{1,2}[ ]\d{2}[:]\d{2}[:]\d{2}$/.test(n),!!val||!($.validator.messages["datetime-local"]="Please enter the date in DD/MM/YYYY 00:00 format"))},"That's not a valid date"),$.validator.addMethod("min",function(e,t){if("date"!=$(t).attr("type"))return this.optional(t)||parseInt(e)>=parseInt($(t).attr("min"));var n=Date.parse($(t).attr("min")),a=formatDate(e),r=Date.parse(a);return null==r?!($.validator.messages.min="Please enter a valid date"):!!(this.optional(t)||0<=r.compareTo(n))||($.validator.messages.min="Please enter a value greater than or equal to "+n.getFullYear()+"-"+(n.getMonth()+1)+"-"+n.getDate()+".",!1)},"Please enter a value greater than or equal to {0}."),$.validator.addMethod("max",function(e,t){if("date"!=$(t).attr("type")&&"datetime-local"!=$(t).attr("type"))return this.optional(t)||parseInt(e)<=parseInt($(t).attr("max"));var n=Date.parse($(t).attr("max")),a=formatDate(e),r=Date.parse(a);return null==r?!($.validator.messages.max="Please enter a valid date"):!!(this.optional(t)||r.compareTo(n)<=0)||($.validator.messages.max="Please enter a value less than or equal to "+n.getDate()+"/"+(n.getMonth()+1)+"/"+n.getFullYear()+".",!1)},"Please enter a value less than or equal to {0}."),$.validator.addMethod("activationCode",function(e,t){return!this.optional(t)&&!/[0oO]/.test(e)},"o or 0 are not allowed characters, please enter Q instead."),$.validator.addMethod("simSsnActivationCode",function(e,t){var n=$(t).data("invalid-codes");return n&&-1<n.indexOf(e.toUpperCase())?!($.validator.messages.simSsnActivationCode="We need the number that appears above '4GGGx', which is 13 or 16 digits long. This should not include '4GGGx'"):(e=trimInvalidSuffixes($.trim(e.toUpperCase()),$(t)),$(t).val(e),$.validator.messages.simSsnActivationCode="Sorry, that isn't a valid SIM serial number. Please check and try again.",e.length<=6&&/[0oO]/.test(e)?!($.validator.messages.simSsnActivationCode="o or 0 are not allowed characters, please enter Q instead."):!!(this.optional(t)||/^[1-9ABCDEFGHJKLMNPQRSTVWXYZ]{6}$/.test(e)||/^[0-9]{13}$/.test(e)||/^[0-9]{19,20}$/.test(e))||($(this).removeAttr("disabled"),!1))},"Sorry, that isn't a valid SIM serial number. Please check and try again."),$.validator.addMethod("nickname_format",function(e,t){return this.optional(t)||/^[\w_]+$/.test($.trim(e))?e.length<4?(addToDataLayerTracking("Membername validation"),$(".icon-15x15-success").remove(),!1):!(/^\d+$/.test($.trim(e))&&8<e.length)||(addToDataLayerTracking("Membername validation"),$(".icon-15x15-success").remove(),!1):(addToDataLayerTracking("Membername validation"),$(".icon-15x15-success").remove(),!1)},"Your member name can include letters, numbers and _. It should be between 4-25 characters, or maximum 8 characters if you only include numbers."),$.validator.addMethod("auto_loginname_format",function(e,t){return!(!this.optional(t)&&!/^[\d\w_]+$/.test($.trim(e)))||"string"==typeof e&&(result=null!==e.match(/^[a-zA-Z0-9._-]+([+][a-zA-Z0-9._-]+){0,1}[@][a-zA-Z0-9._-]+[.][a-zA-Z]{1,6}$/),result=result&&!e.match(/\.\./),result)},"Only letters, numbers and underscores are allowed in your member name. Or try logging in with your email address"),$.validator.addMethod("loginname_format",function(e,t){return this.optional(t)||/^[\d\w_]+$/.test($.trim(e))},"Only letters, numbers and underscores are allowed in your member name."),$.validator.addMethod("password_format",function(e,t){return this.optional(t)||/^(?=.*?[A-Z])(?=.*?[a-z])((?=.*?[0-9])|(?=.*?[#?!@$%^&*-])).{8,64}$/.test(e)},"Your password must contain at least one upper case and one lower case letter and one number or symbol."),$.validator.addMethod("name_format",function(e,t){return this.optional(t)||/^[A-Za-z\s'-]+$/.test(e)},"We only allow letters, plus the following characters: ' and -"),$.validator.addMethod("test_name_format",function(e,t){return this.optional(t)||/^[A-Za-z0-9\s'_-]+$/.test(e)},"We only allow letters, plus the following characters: ', _ and -"),$.validator.addMethod("address_format",function(e,t){return this.optional(t)||/^[\w\s,'\-]+$/.test(e)},"We only allow letters and numbers, plus the following characters: ' - _ and ,"),$.validator.addMethod("international_address_format",function(e,t){return this.optional(t)||/^[\w\s,'\-\/]+$/.test(e)},"We only allow letters and numbers, plus the following characters: ' - _ / and ,"),$.validator.addMethod("phone",function(e,t){e=removeSpace(e);return this.optional(t)||9<e.length&&e.match(/^(\(?(0|\+44|0044|44)[1-9]{1}\d{1,4}?\)?\s?\d{3,4}\s?\d{3,4})$/)},"Please specify a valid phone number"),$.validator.addMethod("paccode",function(e,t){return e.match(/^([A-Za-z]{3}\d{6})$/)},"Enter a valid Porting Authorisation Code (ABC123456)"),$.validator.addMethod("staccode",function(e,t){return e.match(/^(\d{6}[A-Za-z]{3})$/)},"Enter a valid STAC Authorisation Code (123456ABC)"),$.validator.addMethod("security-code",function(e,t){return 3==e.length},"The security code must be 3 digits (i.e. 123)"),$.validator.addMethod("paccode_gg",function(e,t){return!e.match(/^GGF|ggf/)},"You can't use a giffgaff Porting Authorisation Code"),$.validator.addMethod("staccode_gg",function(e,t){return!e.match(/^GGF|ggf/)},"You can't use a giffgaff Porting Authorisation Code"),$.validator.addMethod("transfer",function(e,t){var n=removeSpace(e);return this.optional(t)||11==n.length&&n.match(/^(\(?(07)[0-9]{1}\d{1,4}?\)?\s?\d{3,4}\s?\d{3,4})$/)},"Enter a valid UK phone number (starting 07)"),$.validator.addMethod("compare_giffgaff_number",function(e,t){return $("#giffgaff_account").val()!=removeSpace(e)},"Doh, you can't transfer to your existing giffgaff number. Enter a different UK mobile number (starting 07)."),$.validator.addMethod("compare_transfer_number",function(e,t){return $("#transferNumber").data("msidn")!=removeSpace(e)},"Doh, you can't transfer to your existing giffgaff number. Enter a different UK mobile number (starting 07)."),$.validator.addMethod("checkDate",function(e,t){var n=formatDate(e);if(null!=Date.parse(n)&&(val=this.optional(t)||/^\d{1,2}[\/]\d{1,2}[\/]\d{4}$/.test(e)||/^\d{4}[-]\d{1,2}[-]\d{1,2}$/.test(e),val)){var a=n.split("/"),r=parseInt(a[0],10),i=parseInt(a[1],10),o=parseInt(a[2],10),s=new Date(o,r-1,i);return s.getFullYear()==o&&s.getMonth()+1==r&&s.getDate()==i&&($(t).siblings("span.error").remove(),!0)}return!1},"Invalid date"),$.validator.addMethod("verifyTransferDate",function(e,t){return!!isValidTransferDate(formatDate(e))&&($(t).siblings("span.error").remove(),!0)},"Please pick a valid date (less than 30 days ago and no more than 14 days from today)."),$.validator.addMethod("postcode",function(e,t){var n="[A-PR-UWYZ]",a="[A-HK-Y]",r=new RegExp("^((GIR 0AA)|((("+n+"[0-9][0-9]?)|("+n+a+"[0-9][0-9]?)|("+n+"[0-9][A-HJKSTUW])|("+n+a+"[0-9][ABEHMNPRVWXY]))[ ]?[0-9][ABDEFGHJLNPQRSTUWXYZ]{2}))$","i");return this.optional(t)||r.test($.trim(e))},"Must be a UK postcode"),$.validator.addMethod("IntnlPostcode",function(e,t){return this.optional(t)||/^[a-zA-Z0-9 -]+$/.test($.trim(e))},"We only allow letters, numbers, spaces and hyphens."),$.validator.addMethod("card-detect",function(e,t){var n=e.replace(/\D/g,"");if(/^(6011|622(12[6-9]|1[3-9][0-9]|[2-8][0-9]{2}|9[0-1][0-9]|92[0-5]|64[4-9])|65)/.test(n))return!($.validator.messages["card-detect"]="Sorry Discover cards are not allowed.");if(/^3[47]\d{13}$/.test(n))return!($.validator.messages["card-detect"]="Sorry Amex cards are not allowed.");if(/^35(2[89]|[3-8][0-9])/.test(n))return!($.validator.messages["card-detect"]="Sorry JCB cards are not allowed.");if(/^30[0-5]/.test(n)||/^36/.test(n))return!($.validator.messages["card-detect"]="Sorry Diners club cards are not allowed.");if(/^(6304|670[69]|67(31|71))/.test(n))return!($.validator.messages["card-detect"]="Sorry Maestro cards are not allowed.");if(/^(0000)/.test(n))$.validator.messages["card-detect"]="Sorry, that card number isn't valid. Please try again.";else if(/^(670[3]|6243|6250|5019|5066|6062|6445|4360|6731)/.test(n))return!($.validator.messages["card-detect"]="Sorry, this card isn't accepted.");return!0},"Sorry, that card number isn't valid. Please try again."),$.validator.addMethod("cardnumber",function(e,t){var n=e.replace(/\D/g,""),a=new RegExp("^[0-9]{16,19}$","i"),r=this.optional(t)||a.test(n);return!r&&$("div.cards-list")&&$("div.cards-list i").removeClass("cards-overlay"),r},"Sorry, that card number isn't valid. Please try again."),$.validator.addMethod("luhnnumber",function(e,t){var n=e.replace(/\D/g,""),a=n.length,r=a%2,o=0;for(i=0;i<a;i++){var s=n.charAt(i);i%2==r&&9<(s*=2)&&(s-=9),o+=parseInt(s)}var d=o%10==0;return!d&&$("div.cards-list")&&$("div.cards-list i").removeClass("cards-overlay"),d},"Sorry, that card number isn't valid. Please try again."),$.validator.addMethod("card-expiring-date",function(e,t){var n=new Date,a=n.getMonth()+1,r=n.getFullYear(),i=$("#card_expiring_date_month").val(),o=$("#card_expiring_date_year").val();return""==i||""==o||!(o<r||o==r&&i<a)},"The expiry date must be next month or later to be valid."),$.validator.addMethod("stripe-card-expiring-date",function(e,t){var n,a,r;return $expDate=e.split("/"),month=$expDate[0],year=$expDate[1],"object"==typeof month&&"month"in month&&(r=month,month=r.month,year=r.year),!(!month||!year)&&(month=$.trim(month),year=$.trim(year),!!/^\d+$/.test(month)&&(!!/^\d+$/.test(year)&&(1<=month&&month<=12&&(2===year.length&&(year<70?year="20"+year:year="19"+year),4===year.length&&(a=new Date(year,month),n=new Date,a.setMonth(a.getMonth()-1),a.setMonth(a.getMonth()+1,1),n<a)))))},"Please enter a valid date."),$.validator.addMethod("birthdate",function(e,t){$("#"+t.id).parent();var n=$("#birthdate_day").val(),a=$("#birthdate_month").val(),r=$("#birthdate_year").val();if(""!=n&&""!=a&&""!=r){var i=new Date(a+"/"+n+"/"+r),o=new Date;if(i.getMonth()+1!=a||i.getDate()!=n||i.getFullYear()!=r)return!1;if(i.getTime()>o.getTime())return!1}return!0},"We all like being original, but the date you've just introduced is simply impossible."),$.validator.addMethod("password_include_nickname",function(e,t){var n=0<$("#signup_nickname").length?$("#signup_nickname").val().toLowerCase():"",a=e.toLowerCase();return this.optional(t)||""==n||-1==a.indexOf(n)},"Your password can't include your member name, for security reasons. Please try again."),$.validator.addMethod("remote_nickname",function(i,o){if(this.optional(o))return"dependency-mismatch";var s=this.previousValue(o);if(this.settings.messages[o.name]||(this.settings.messages[o.name]={}),s.originalMessage=this.settings.messages[o.name].remote,this.settings.messages[o.name].remote=s.message,this.pending[o.name])return"pending";if(s.old===i)return s.valid;s.old=i;var d=this;this.startRequest(o);return{}[o.name]=i,$.ajax($.extend(!0,{type:"GET",url:"/ajax-helper/nickname-available",data:{json:1,nickname:$.trim($(o).val())},dataType:"html",mode:"abort",port:"validate"+o.name,beforeSend:function(){$(".icon-15x15-success").remove(),$('<i class="icon-15x15-loading"></i>').insertAfter(o),spinner()},success:function(e){d.settings.messages[o.name].remote=s.originalMessage,$(".icon-15x15-loading").remove();var t=e;if("true"==t){var n=d.formSubmitted;d.prepareElement(o),d.formSubmitted=n,d.successList.push(o),d.showErrors(),$('<span>&nbsp;<i class="icon-15x15-success"></i></span>').insertAfter(o),o.classList.remove("nickname-error")}else{var a={},r="This username has already been taken";a[o.name]=s.message=$.isFunction(r)?r(i):r,o.classList.add("nickname-error"),d.showErrors(a),addToDataLayerTracking("Membername taken")}s.valid=t,d.stopRequest(o,t)}},{})),"pending"}),$.validator.addMethod("nickname-error",function(e,t){var n={},a="This username has already been taken";return n[t.name]=a,this.showErrors(n),a}),$.validator.addMethod("recommender",function(e,t){if(this.optional(t))return!0;return $.ajax({cache:!1,async:!1,type:"POST",data:{nickname:e,json:1},url:"/ajax-helper/nickname-available",dataType:"json",beforeSend:function(){$(".icon-15x15-success").remove(),$('<i class="icon-15x15-loading"></i>').insertAfter(t),spinner()},success:function(e){$(".icon-15x15-loading").remove(),result=1!=e}}),result},"There isn't any giffgaff member with this name"),$.validator.addMethod("phoneUK",function(e,t,n){return this.optional(t)||9<e.length&&e.match(/^(((\+44)? ?(\(0\))? ?)|(0))( ?[0-9]{3,4}){3}$/)},"Please specify a valid phone number"),$.validator.addMethod("compareDate",function(e,t,n){if("datetime-local"==$(t).attr("type")||"date"==$(t).attr("type"))return toDate=Date.parse(formatDate($(t).val())),fromDate=Date.parse(formatDate($("#"+n).val())),fromDate.compareTo(toDate)<0},"To date should be greater than From date"),$.validator.addMethod("simSerialNumber",function(e,t){return"13"==e.length||"19"==e.length},"This serial number is incorrect, please verify it"),$.validator.addMethod("passportLineLength",function(e,t){return!(!$(t).is(":hidden")&&e&&"44"!=e.length)},"Your passport number can only include letters, numbers and chevron (<) and must be 44 characters"),$.validator.addMethod("passportValid",function(e,t){var n=new RegExp("(^[a-zA-Z0-9<]+)$");return this.optional(t)||n.test(e)},"Your passport number can only include letters, numbers and chevron (<) and must be 44 characters"),$.validator.addMethod("passportOrLicense",function(e,t){return!($(t).is(":visible")&&!e&&!$("#driving_license").val())},"Required"),$.validator.addMethod("dlicenseLength",function(e,t){return!e||"18"==e.length},"Enter a valid UK licence number"),$.validator.addMethod("over18",function(e,t){return!(!$(t).is(":hidden")&&!$(t).is(":checked"))},"Required"),$.validator.addMethod("accountNumber",function(e,t){return!!e.match(/^([0-9]{8})$/)},"Invalid Account Number"),$.validator.addMethod("sortcode",function(e,t){return!(e.match(/[^\d]/)||e.length<2)},"Invalid Sort Code"),$.validator.addMethod("alpha",function(e,t){return!!e.match(/^[a-zA-Z\s]*$/)},"Please enter only letters"),$.validator.addMethod("DOBOver18",function(e,t){if("0"==e)return!($.validator.messages.DOBOver18="Required field.");$("#"+t.id).parent();var n=$("#birthdate_day").val(),a=$("#birthdate_month").val(),r=$("#birthdate_year").val();if("0"!=n&&"0"!=a&&"0"!=r){var i=parseInt(r)+18,o=new Date(a+"/"+n+"/"+i),s=new Date;if(o.getTime()>s.getTime())return!($.validator.messages.DOBOver18="You need to be over 18 to pay over time.")}return!0},"You need to be over 18 to pay over time."),$.validator.addMethod("month-year-comparable",function(e,t){var n=$("#"+t.id).parent(),a=$("#"+t.id).data("compare-field-prefix");if(t.id==a+"_month"||t.id==a+"_year")return!0;var r=n.children(".month").val(),i=n.children(".year").val(),o=$("#"+a+"_month").val(),s=$("#"+a+"_year").val();if(""!=r&&""!=i&&""!=o&&""!=s){var d=new Date(r+"/1/"+i),l=new Date(o+"/1/"+s);if(d.getTime()>=l.getTime())return!1}return!0},"Please select a date past the start date for preceding address."),$.validator.addMethod("multi-paf-address-required",function(e,t){var n=$("#"+t.id).parents("form").data("paf-min-years"),a=$("#"+t.id).data("paf-prefix"),r=$("#"+t.id).data("compare-field-prefix");if(a===r)return!0;var i=$(t).val().replace(" ",""),o=$("#"+r+"movedate_movedInMonth").val(),s=$("#"+r+"movedate_movedInYear").val();return!(""!=o&&""!=s&&monthDiff(new Date(s,o-1,1),getLastDayOfMonth())<12*n&&0===i.length)},"Required field."),$.validator.addMethod("overseas-address",function(e,t){return"0"===$("input[name="+$(t).attr("name")+"]:checked").val()},"Sorry, if you have lived overseas in the past 3 years, we cannot proceed with your loan."),$.validator.addMethod("address-comparable",function(e,t){$("#"+t.id).parents(".controls");var n=$("#"+t.id).parents("form"),a=$("#"+t.id).data("paf-prefix"),r=$("#"+t.id).data("compare-field-prefix"),i=$("#"+r+"postcode");if(t.id==r+"postcode"||void 0===i)return!0;var o=(n.find('input[name="'+a+'line1"]').val()+n.find('input[name="'+a+'line2"]').val()+n.find('input[name="'+a+'city"]').val()+$("#"+t.id).val()).replace(" ","").toUpperCase(),s=(n.find('input[name="'+r+'line1"]').val()+n.find('input[name="'+r+'line2"]').val()+n.find('input[name="'+r+'city"]').val()+i.val()).replace(" ","").toUpperCase();return o!==s||(0===o.length&&0===s.length||void 0===o.length&&void 0===s.length)},"Cannot be the same address as above, please enter your former address."),$.validator.addMethod("email",function(e,t){var n=!0;return"string"==typeof e&&(n=(n=null!==e.match(/^[a-zA-Z0-9._-]+([+][a-zA-Z0-9._-]+){0,1}[@][a-zA-Z0-9._-]+[.][a-zA-Z]{1,6}$/))&&!e.match(/\.\./)),n}),$.validator.addMethod("ask-agent-date",function(e,t){return!!this.optional(t)||null!=e&&(!!validateDate(e)&&($(t).siblings("span.error").remove(),$(t).css("border-color","#ccc"),!0))},"Please enter a valid date in dd/mm/yyyy format")),validateDate=function(e){var t=e;if(t.match(/^(0?[1-9]|[12][0-9]|3[01])[\/\-](0?[1-9]|1[012])[\/\-]\d{4}$/)){var n=t.split("/"),a=t.split("-");if(1<n.length)var r=t.split("/");else if(1<a.length)r=t.split("-");var i=parseInt(r[0]),o=parseInt(r[1]),s=parseInt(r[2]);if((1==o||2<o)&&[31,28,31,30,31,30,31,31,30,31,30,31][o-1]<i)return!1;if(2==o){var d=!1;if((s%4||!(s%100))&&s%400||(d=!0),0==d&&29<=i)return!1;if(1==d&&29<i)return!1}return!0}return!1},formatDate=function(e){if(-1!=(e=stripDate(e)).search("/")){var t=e.split("/");return day=t[0],month=t[1],year=t[2],month+"/"+day+"/"+year}return-1!=e.search("-")?(t=e.split("-"),day=t[2],month=t[1],year=t[0],month+"/"+day+"/"+year):e},stripDate=function(e){return(e=e.replace("T"," ")).indexOf("Z")?e=trim(e.replace("Z","")):e};var trimInvalidSuffixes=function(n,e){var t=e.data("invalid-suffixes");try{t&&$.each(t,function(e,t){if(13<n.length&&-1<n.indexOf(t,n.length-t.length))return n=n.substr(0,n.length-t.length)})}catch(e){return n}return n};(function(){var m,p=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};(m=jQuery).fn.validateCreditCard=function(a,r){var i,o,s,d,l,c,t,e,n,u,g,h;for(s=[{name:"amex",pattern:"^3[47]",valid_length:[15]},{name:"diners_club_carte_blanche",pattern:"^30[0-5]",valid_length:[14]},{name:"diners_club_international",pattern:"^36",valid_length:[14]},{name:"jcb",pattern:"^35(2[89]|[3-8][0-9])",valid_length:[16]},{name:"laser",pattern:"^(6304|670[69]|6771)",valid_length:[16,17,18,19]},{name:"electron",pattern:"^(4026|417500|4508|4844|491(3|7))",valid_length:[16,19]},{name:"delta",pattern:"^400626|40854749|408456|408457|409400|409402|408456|408457|407704|41228586|41373337|41378788|418825|418760|41917679|419772|420672|42159294|422793|423769|431072|444001|44400508|44620011|44621354|44625772|44627483|446286|446294|450875|45397|454313|45443235|454742|45672545|46583079|46590150|47511059|47571059|47622069|47634089|48440910|484427|49096079|49218182|495065|495067|495090|498824|499806|499844|499846",valid_length:[16,19]},{name:"visa",pattern:"^4",valid_length:[16,19]},{name:"mastercard",pattern:"^5[1-5]",valid_length:[16]},{name:"maestro",pattern:"^(5018|5020|5038|6304|6759|676[1-3])",valid_length:[12,13,14,15,16,17,18,19]},{name:"discover",pattern:"^(6011|622(12[6-9]|1[3-9][0-9]|[2-8][0-9]{2}|9[0-1][0-9]|92[0-5]|64[4-9])|65)",valid_length:[16]}],null==r&&(r={}),r.cardinfo&&(s=r.cardinfo),null==r.accept&&(r.accept=function(){var e,t,n;for(n=[],e=0,t=s.length;e<t;e++)i=s[e],n.push(i.name);return n}()),u=0,g=(h=r.accept).length;u<g;u++)if(o=h[u],p.call(function(){var e,t,n;for(n=[],e=0,t=s.length;e<t;e++)i=s[e],n.push(i.name);return n}(),o)<0)throw"Credit card type '"+o+"' is not supported";return d=function(e){var t,n,a;for(t=0,n=(a=function(){var e,t,n,a;for(a=[],e=0,t=s.length;e<t;e++)n=(i=s[e]).name,0<=p.call(r.accept,n)&&a.push(i);return a}()).length;t<n;t++)if(o=a[t],e.match(new RegExp(o.pattern)))return o;return null},c=function(e){var t,n,a,r,i,o;for(n=r=a=0,i=(o=e.split("").reverse()).length;r<i;n=++r)t=+(t=o[n]),a+=n%2?(t*=2)<10?t:t-9:t;return a%10==0},l=function(e,t){var n;return n=e.length,0<=p.call(t.valid_length,n)},n=function(e){var t,n;return t=n=!1,null!=(o=d(e))&&(n=c(e),t=l(e,o)),a({card_type:o,luhn_valid:n,length_valid:t})},e=function(){var e;return e=t(m(this).val()),n(e)},t=function(e){return e.replace(/[ -]/g,"")},this.bind("input",function(){return e.call(this)}),this.bind("keyup",function(){return e.call(this)}),0!==this.length&&e.call(this),this}}).call(this),(gg=gg||{}).widgets=gg.widgets||{},gg.widgets.creditCardInput=function(){var t=$(".card-mask"),n="0000 0000 0000 0000 000",a=19;t.mask(n);var l=function(e){e!==a&&void 0!==e&&(n=r(e),t.mask(n.trim()),a=e)},r=function(e){for(var t="",n=0;n<e;n++)splitDel=t.length%5==0?" ":"",t=t+splitDel+"0";return t},i=function(){var e=$("input[name=user-client-info]"),a=e.length,r=[];a&&e.each(function(e,t){var n;(r.push(t),""===t.value)&&(e==a-1&&(n="screenHeight="+(screen.height||"")+",screenWidth="+(screen.width||"")+",colorDepth="+(screen.colorDepth||"")+",timeZoneOffset="+(new Date).getTimezoneOffset()+",javaEnabled="+navigator.javaEnabled(),r.forEach(function(e,t){e.value=n})))})},o=function(){var e=$(".card-detect"),t=e.data("cards-validation-info");e.validateCreditCard(function(e){var t,n,a,r,i,o,s=null,d=19;e.card_type&&(s=e.card_type.name,d=Math.max.apply(Math,e.card_type.valid_length)),t=s,(n=$("div.cards-list i")).removeClass("cards-overlay"),t&&(n.addClass("cards-overlay"),$("div.cards-list i.icon-24x24cards-"+t).removeClass("cards-overlay")),l(d),a=s,r=$("#card_issue_number"),i=$("#maestro-message"),r.closest("div[class^=control-group]").addClass("hide"),i.hide(),"maestro"===a&&(r.closest("div[class^=control-group]").removeClass("hide"),i.hasClass("auto-reccur")&&i.show()),o=s,0<$("#cc_card_type").length&&(void 0!==o&&null!=o?$("#cc_card_type").val(o):$("#cc_card_type").val(""))},{cardinfo:t})};return{init:function(){var e;i(),o(),l(),0<(e=$("input#expiry_date")).length&&e.payment("formatCardExpiry"),$("#sortcode_first,#sortcode_second,#sortcode_third").keyup(function(e){9==(e.which||e.keyCode)?$(".sortcode").removeClass("autotab"):$(this).hasClass("autotab")&&($(this).val().length==$(this).attr("maxlength")&&""==$(this).next(":input").val()?$(this).next(":input").focus():""==$(this).prev(":input").val()&&$(this).prev(":input").focus())})}}},$(document).ready(function(){gg.widgets.creditCardInput().init()}),function(){var d,l,r,c,e,t,n,a,i,o,s,u,g,h,m,p,f,v,y,b,C,w,$,F,k=[].slice,D=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};(d=window.jQuery||window.Zepto||window.$).payment={},d.payment.fn={},d.fn.payment=function(){var e,t;return t=arguments[0],e=2<=arguments.length?k.call(arguments,1):[],d.payment.fn[t].apply(this,e)},e=/(\d{1,4})/g,d.payment.cards=c=[{type:"visaelectron",patterns:[4026,417500,4405,4508,4844,4913,4917],format:e,length:[16],cvcLength:[3],luhn:!0},{type:"maestro",patterns:[5018,502,503,56,58,639,6220,67],format:e,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:!0},{type:"forbrugsforeningen",patterns:[600],format:e,length:[16],cvcLength:[3],luhn:!0},{type:"dankort",patterns:[5019],format:e,length:[16],cvcLength:[3],luhn:!0},{type:"visa",patterns:[4],format:e,length:[13,16],cvcLength:[3],luhn:!0},{type:"mastercard",patterns:[51,52,53,54,55,22,23,24,25,26,27],format:e,length:[16],cvcLength:[3],luhn:!0},{type:"amex",patterns:[34,37],format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[3,4],luhn:!0},{type:"dinersclub",patterns:[30,36,38,39],format:/(\d{1,4})(\d{1,6})?(\d{1,4})?/,length:[14],cvcLength:[3],luhn:!0},{type:"discover",patterns:[60,64,65,622],format:e,length:[16],cvcLength:[3],luhn:!0},{type:"unionpay",patterns:[62,88],format:e,length:[16,17,18,19],cvcLength:[3],luhn:!1},{type:"jcb",patterns:[35],format:e,length:[16],cvcLength:[3],luhn:!0}],l=function(e){var t,n,a,r,i,o,s;for(e=(e+"").replace(/\D/g,""),a=0,i=c.length;a<i;a++)for(r=0,o=(s=(t=c[a]).patterns).length;r<o;r++)if(n=s[r]+"",e.substr(0,n.length)===n)return t},r=function(e){var t,n,a;for(n=0,a=c.length;n<a;n++)if((t=c[n]).type===e)return t},g=function(e){var t,n,a,r,i,o;for(a=!0,i=r=0,o=(n=(e+"").split("").reverse()).length;i<o;i++)t=n[i],t=parseInt(t,10),(a=!a)&&(t*=2),9<t&&(t-=9),r+=t;return r%10==0},u=function(e){var t;return null!=e.prop("selectionStart")&&e.prop("selectionStart")!==e.prop("selectionEnd")||!(null==("undefined"!=typeof document&&null!==document&&null!=(t=document.selection)?t.createRange:void 0)||!document.selection.createRange().text)},$=function(e,t){var n,a;try{n=t.prop("selectionStart")}catch(e){e,n=null}if(a=t.val(),t.val(e),null!==n&&t.is(":focus"))return n===a.length&&(n=e.length),t.prop("selectionStart",n),t.prop("selectionEnd",n)},v=function(e){var t,n,a,r,i,o;for(null==e&&(e=""),"","0123456789",r="",i=0,o=(t=e.split("")).length;i<o;i++)n=t[i],-1<(a="".indexOf(n))&&(n="0123456789"[a]),r+=n;return r},f=function(n){return setTimeout(function(){var e,t;return t=(e=d(n.currentTarget)).val(),t=(t=v(t)).replace(/\D/g,""),$(t,e)})},m=function(n){return setTimeout(function(){var e,t;return t=(e=d(n.currentTarget)).val(),t=v(t),t=d.payment.formatCardNumber(t),$(t,e)})},a=function(e){var t,n,a,r,i,o,s;if(a=String.fromCharCode(e.which),/^\d+$/.test(a)&&(t=d(e.currentTarget),s=t.val(),n=l(s+a),r=(s.replace(/\D/g,"")+a).length,o=16,n&&(o=n.length[n.length.length-1]),!(o<=r||null!=t.prop("selectionStart")&&t.prop("selectionStart")!==s.length)))return(i=n&&"amex"===n.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/).test(s)?(e.preventDefault(),setTimeout(function(){return t.val(s+" "+a)})):i.test(s+a)?(e.preventDefault(),setTimeout(function(){return t.val(s+a+" ")})):void 0},t=function(e){var t,n;if(t=d(e.currentTarget),n=t.val(),8===e.which&&(null==t.prop("selectionStart")||t.prop("selectionStart")===n.length))return/\d\s$/.test(n)?(e.preventDefault(),setTimeout(function(){return t.val(n.replace(/\d\s$/,""))})):/\s\d?$/.test(n)?(e.preventDefault(),setTimeout(function(){return t.val(n.replace(/\d$/,""))})):void 0},p=function(n){return setTimeout(function(){var e,t;return t=(e=d(n.currentTarget)).val(),t=v(t),t=d.payment.formatExpiry(t),$(t,e)})},i=function(e){var n,t,a;if(t=String.fromCharCode(e.which),/^\d+$/.test(t))return n=d(e.currentTarget),a=n.val()+t,/^\d$/.test(a)&&"0"!==a&&"1"!==a?(e.preventDefault(),setTimeout(function(){return n.val("0"+a+" / ")})):/^\d\d$/.test(a)?(e.preventDefault(),setTimeout(function(){var e,t;return e=parseInt(a[0],10),2<(t=parseInt(a[1],10))&&0!==e?n.val("0"+e+" / "+t):n.val(a+" / ")})):void 0},o=function(e){var t,n,a;if(n=String.fromCharCode(e.which),/^\d+$/.test(n))return a=(t=d(e.currentTarget)).val(),/^\d\d$/.test(a)?t.val(a+" / "):void 0},s=function(e){var t,n,a;if("/"===(a=String.fromCharCode(e.which))||" "===a)return n=(t=d(e.currentTarget)).val(),/^\d$/.test(n)&&"0"!==n?t.val("0"+n+" / "):void 0},n=function(e){var t,n;if(t=d(e.currentTarget),n=t.val(),8===e.which&&(null==t.prop("selectionStart")||t.prop("selectionStart")===n.length))return/\d\s\/\s$/.test(n)?(e.preventDefault(),setTimeout(function(){return t.val(n.replace(/\d\s\/\s$/,""))})):void 0},h=function(n){return setTimeout(function(){var e,t;return t=(e=d(n.currentTarget)).val(),t=(t=v(t)).replace(/\D/g,"").slice(0,4),$(t,e)})},w=function(e){var t;return!(!e.metaKey&&!e.ctrlKey)||32!==e.which&&(0===e.which||(e.which<33||(t=String.fromCharCode(e.which),!!/[\d\s]/.test(t))))},b=function(e){var t,n,a,r;if(t=d(e.currentTarget),a=String.fromCharCode(e.which),/^\d+$/.test(a)&&!u(t))return r=(t.val()+a).replace(/\D/g,""),(n=l(r))?r.length<=n.length[n.length.length-1]:r.length<=16},C=function(e){var t,n;if(t=d(e.currentTarget),n=String.fromCharCode(e.which),/^\d+$/.test(n)&&!u(t))return!(6<(t.val()+n).replace(/\D/g,"").length)&&void 0},y=function(e){var t,n;if(t=d(e.currentTarget),n=String.fromCharCode(e.which),/^\d+$/.test(n)&&!u(t))return(t.val()+n).length<=4},F=function(e){var t,n,a,r,i;if(i=(t=d(e.currentTarget)).val(),r=d.payment.cardType(i)||"unknown",!t.hasClass(r))return n=function(){var e,t,n;for(n=[],e=0,t=c.length;e<t;e++)a=c[e],n.push(a.type);return n}(),t.removeClass("unknown"),t.removeClass(n.join(" ")),t.addClass(r),t.toggleClass("identified","unknown"!==r),t.trigger("payment.cardType",r)},d.payment.fn.formatCardCVC=function(){return this.on("keypress",w),this.on("keypress",y),this.on("paste",h),this.on("change",h),this.on("input",h),this},d.payment.fn.formatCardExpiry=function(){return this.on("keypress",w),this.on("keypress",C),this.on("keypress",i),this.on("keypress",s),this.on("keypress",o),this.on("keydown",n),this.on("change",p),this.on("input",p),this},d.payment.fn.formatCardNumber=function(){return this.on("keypress",w),this.on("keypress",b),this.on("keypress",a),this.on("keydown",t),this.on("keyup",F),this.on("paste",m),this.on("change",m),this.on("input",m),this.on("input",F),this},d.payment.fn.restrictNumeric=function(){return this.on("keypress",w),this.on("paste",f),this.on("change",f),this.on("input",f),this},d.payment.fn.cardExpiryVal=function(){return d.payment.cardExpiryVal(d(this).val())},d.payment.cardExpiryVal=function(e){var t,n,a;return t=(a=e.split(/[\s\/]+/,2))[0],2===(null!=(n=a[1])?n.length:void 0)&&/^\d+$/.test(n)&&(n=(new Date).getFullYear().toString().slice(0,2)+n),{month:t=parseInt(t,10),year:n=parseInt(n,10)}},d.payment.validateCardNumber=function(e){var t,n;return e=(e+"").replace(/\s+|-/g,""),!!/^\d+$/.test(e)&&(!!(t=l(e))&&(n=e.length,0<=D.call(t.length,n)&&(!1===t.luhn||g(e))))},d.payment.validateCardExpiry=function(e,t){var n,a,r;return"object"==typeof e&&"month"in e&&(e=(r=e).month,t=r.year),!(!e||!t)&&(e=d.trim(e),t=d.trim(t),!!/^\d+$/.test(e)&&(!!/^\d+$/.test(t)&&(1<=e&&e<=12&&(2===t.length&&(t=t<70?"20"+t:"19"+t),4===t.length&&(a=new Date(t,e),n=new Date,a.setMonth(a.getMonth()-1),a.setMonth(a.getMonth()+1,1),n<a)))))},d.payment.validateCardCVC=function(e,t){var n,a;return e=d.trim(e),!!/^\d+$/.test(e)&&(null!=(n=r(t))?(a=e.length,0<=D.call(n.cvcLength,a)):3<=e.length&&e.length<=4)},d.payment.cardType=function(e){var t;return e&&(null!=(t=l(e))?t.type:void 0)||null},d.payment.formatCardNumber=function(e){var t,n,a,r;return e=e.replace(/\D/g,""),(t=l(e))?(a=t.length[t.length.length-1],e=e.slice(0,a),t.format.global?null!=(r=e.match(t.format))?r.join(" "):void 0:null!=(n=t.format.exec(e))?(n.shift(),(n=d.grep(n,function(e){return e})).join(" ")):void 0):e},d.payment.formatExpiry=function(e){var t,n,a,r;return(n=e.match(/^\D*(\d{1,2})(\D+)?(\d{1,4})?/))?(t=n[1]||"",a=n[2]||"",0<(r=n[3]||"").length?a=" / ":" /"===a?(t=t.substring(0,1),a=""):2===t.length||0<a.length?a=" / ":1===t.length&&"0"!==t&&"1"!==t&&(t="0"+t,a=" / "),t+a+r):""}}.call(this),(gg=gg||{}).widgets=gg.widgets||{},gg.widgets.register=function(){var n=null,a=/^[a-zA-Z0-9\-\_.@]+$/gm;function e(e){var t=e;null!==t.match(a)&&($("#email2").val(t),n.find("div").html(0===t.length?"&nbsp;":t))}return{init:function(){return n=$("#emailConfirm"),0===$("div",n).length&&n.append("<div>"),$("#email1").on("keyup input",function(){e($(this).val().trim())}),$("#register-here .btn-secondary").click(function(){$(this).parent().hide(),$("#register-form").show(),$("#signup_nickname").focus()}),$(".radio-btn-wrap input[name=promotions]").click(function(){$(".radio-btn-wrap").removeClass("radio-btn-wrap__active"),$(this).prop("checked")&&$(this).parent().addClass("radio-btn-wrap__active")}),$("#email1").each(function(){e($(this).val().trim())}),this}}},gg.widgets.registerForm=function(){return{init:function(){$(".btn-show-form").on("click",function(e){e.preventDefault();var t=$(this).data("form-selector"),n=$(this).data("cta-container");$(n).hide(),$(t).slideDown()})}}},gg.widgets.loginForm=function(){function e(){$("#switchMember").on("click",function(e){e.preventDefault(),$.ajax({url:"/ajax-helper/remove-cookie",success:function(e){$(".remembered-info").hide(),$(".login-form-title").show(),$("#nickname").val(""),$("#remember_login").attr("checked",!1),$(".login-name").show(),$("#forgot_password_link").text("Forgotten your member name or password?"),function(){$("#login").hasClass("login-remembered-box")&&$("#login").removeClass("login-remembered-box").addClass("login-box");$("#register-here").hasClass("register-form-remembered-box")&&$("#register-here").removeClass("register-form-remembered-box").addClass("register-form-box")}(),0<$("#login-form").length&&($("#login-form").find(".error").remove(),$("#password").val(""))}})})}return{init:function(){return e(),$("#nickname")&&""===$("#nickname").val()?$("#nickname").focus():$("#password").focus(),this}}},gg.widgets.graphTooltips=function(){return{init:function(){$('[data-toggle="clickable-tooltip"]').tooltip({placement:"top",trigger:"click",delay:{show:500,hide:100}})}}},gg.widgets.phonesCheckout=function(){function e(e){var t=60;window.matchMedia("(max-width: 767px)").matches&&(t=0),$("html, body").animate({scrollTop:$(e).offset().top-t})}return{init:function(){return $("#login-section .tab").on("click",function(){$("#new-member").prop("checked",!0),$("#registered-member").prop("checked",!1),$("#login-section").addClass("shadow"),$("#register-section").removeClass("shadow"),$("#register-section .tab").removeClass("tab-selected"),$("#login-section .tab").addClass("tab-selected"),$("#login").show(),$("#register").hide(),e("#login-section")}),$("#register-section .tab").on("click",function(){$("#new-member").prop("checked",!1),$("#registered-member").prop("checked",!0),$("#register-section").addClass("shadow"),$("#login-section").removeClass("shadow"),$("#login-section .tab").removeClass("tab-selected"),$("#register-section .tab").addClass("tab-selected"),$("#login").hide(),$("#register").show(),e("#register-section")}),this}}},$(document).ready(function(){window.tooltipOptions&&"manual"==window.tooltipOptions.trigger&&$("#password1").tooltip("show"),gg.widgets.register().init(),gg.widgets.registerForm().init(),gg.widgets.loginForm().init(),gg.widgets.graphTooltips().init(),gg.widgets.phonesCheckout().init()}),gg.widgets=gg.widgets||{},gg.widgets.showHidePassword=function(e){return{onToggle:(e=e||{}).onToggle,init:function(){var a=this;$(".show-hide-password-toggle").on("click",function(){$("span",$(this)).toggleClass("hide");var e=$("#"+$(this).data("for")),t=e.clone(!0),n=e.attr("type");t.attr("type","password"===n?"text":"password"),e.replaceWith(t),"function"==typeof a.onToggle&&a.onToggle(t)})}}},$(document).ready(function(){gg.widgets.showHidePassword().init()}),(gg=gg||{}).widgets=gg.widgets||{},gg.widgets.postCodeLabelFixer=function(){return{init:function(){var e=document.querySelectorAll(".ukAddress label[for$='postcode']");setTimeout(function(){try{window.pca&&window.pca.capturePlus||$.each(e,function(){$(this).html("Postcode")})}catch(e){}},3e3)}}};var Mailcheck={domainThreshold:2,secondLevelThreshold:2,topLevelThreshold:2,defaultDomains:["msn.com","bellsouth.net","telus.net","comcast.net","optusnet.com.au","earthlink.net","qq.com","sky.com","icloud.com","mac.com","sympatico.ca","googlemail.com","att.net","xtra.co.nz","web.de","cox.net","gmail.com","ymail.com","aim.com","rogers.com","verizon.net","rocketmail.com","google.com","optonline.net","sbcglobal.net","aol.com","me.com","btinternet.com","charter.net","shaw.ca"],defaultSecondLevelDomains:["yahoo","hotmail","mail","live","outlook","gmx"],defaultTopLevelDomains:["com","com.au","com.tw","ca","co.nz","co.uk","de","fr","it","ru","net","org","edu","gov","jp","nl","kr","se","eu","ie","co.il","us","at","be","dk","hk","es","gr","ch","no","cz","in","net","net.au","info","biz","mil","co.jp","sg","hu"],run:function(e){e.domains=e.domains||Mailcheck.defaultDomains,e.secondLevelDomains=e.secondLevelDomains||Mailcheck.defaultSecondLevelDomains,e.topLevelDomains=e.topLevelDomains||Mailcheck.defaultTopLevelDomains,e.distanceFunction=e.distanceFunction||Mailcheck.sift3Distance;var t=function(e){return e},n=e.suggested||t,a=e.empty||t,r=Mailcheck.suggest(Mailcheck.encodeEmail(e.email),e.domains,e.secondLevelDomains,e.topLevelDomains,e.distanceFunction);return r?n(r):a()},suggest:function(e,t,n,a,r){e=e.toLowerCase();var i=this.splitEmail(e);if(n&&a&&-1!==n.indexOf(i.secondLevelDomain)&&-1!==a.indexOf(i.topLevelDomain))return!1;if(d=this.findClosestDomain(i.domain,t,r,this.domainThreshold))return d!=i.domain&&{address:i.address,domain:d,full:i.address+"@"+d};var o=this.findClosestDomain(i.secondLevelDomain,n,r,this.secondLevelThreshold),s=this.findClosestDomain(i.topLevelDomain,a,r,this.topLevelThreshold);if(i.domain){var d=i.domain,l=!1;if(o&&o!=i.secondLevelDomain&&(d=d.replace(i.secondLevelDomain,o),l=!0),s&&s!=i.topLevelDomain&&(d=d.replace(i.topLevelDomain,s),l=!0),1==l)return{address:i.address,domain:d,full:i.address+"@"+d}}return!1},findClosestDomain:function(e,t,n,a){var r;a=a||this.topLevelThreshold;var i=99,o=null;if(!e||!t)return!1;n||(n=this.sift3Distance);for(var s=0;s<t.length;s++){if(e===t[s])return e;(r=n(e,t[s]))<i&&(i=r,o=t[s])}return i<=a&&null!==o&&o},sift3Distance:function(e,t){if(null==e||0===e.length)return null==t||0===t.length?0:t.length;if(null==t||0===t.length)return e.length;for(var n=0,a=0,r=0,i=0;n+a<e.length&&n+r<t.length;){if(e.charAt(n+a)==t.charAt(n+r))i++;else for(var o=r=a=0;o<5;o++){if(n+o<e.length&&e.charAt(n+o)==t.charAt(n)){a=o;break}if(n+o<t.length&&e.charAt(n)==t.charAt(n+o)){r=o;break}}n++}return(e.length+t.length)/2-i},splitEmail:function(e){var t=e.trim().split("@");if(t.length<2)return!1;for(var n=0;n<t.length;n++)if(""===t[n])return!1;var a=t.pop(),r=a.split("."),i="",o="";if(0==r.length)return!1;if(1==r.length)o=r[0];else{i=r[0];for(n=1;n<r.length;n++)o+=r[n]+".";o=o.substring(0,o.length-1)}return{topLevelDomain:o,secondLevelDomain:i,domain:a,address:t.join("@")}},encodeEmail:function(e){var t=encodeURI(e);return t=t.replace("%20"," ").replace("%25","%").replace("%5E","^").replace("%60","`").replace("%7B","{").replace("%7C","|").replace("%7D","}")}};"undefined"!=typeof module&&module.exports&&(module.exports=Mailcheck),"function"==typeof define&&define.amd&&define("mailcheck",[],function(){return Mailcheck}),"undefined"!=typeof window&&window.jQuery&&(jQuery.fn.mailcheck=function(e){var t=this;if(e.suggested){var n=e.suggested;e.suggested=function(e){n(t,e)}}if(e.empty){var a=e.empty;e.empty=function(){a.call(null,t)}}e.email=this.val(),Mailcheck.run(e)}),(gg=gg||{}).controller=gg.controller||{},gg.widgets=gg.widgets||{},gg.widgets.passwordTooltip=function(){var a=null,r=null;function i(e){var t=e.val();if(/^$/.test(t))$(".success, .error",r).removeClass("success error");else if(o(/.{8}/.test(t),".ruleNumCharacters"),o(/[A-Z]/.test(t),".ruleUppercaseLetter"),o(/[a-z]/.test(t),".ruleLowercaseLetter"),o(/([#?!@$%^&*-]|\d)/.test(t),".ruleNumberOrSpecialCharacter"),0<$(a.data("username-field")).length&&void 0!==a.data("username-field")&&""!==$(a.data("username-field")).val()){var n=$(a.data("username-field")).val().toLowerCase();o(-1===t.toLowerCase().indexOf(n),".ruleNotUsername")}}function o(e,t){e?$(t,r).removeClass("error").addClass("success"):$(t,r).removeClass("success").addClass("error")}function s(e){var t="right";($(window).width()<=767||e.parent().width()<=600)&&(t="bottom"),e.data("tooltip").options.placement=t}return{init:function(r){r=r||{};$('[data-toggle="password-tooltip"]').each(function(e,t){var n=$(t),a=n.parent();a.find(".help-block").remove(),a.addClass("mobile-tooltip"),n.tooltip({placement:"right",trigger:r.trigger||"focus",delay:{show:500,hide:100},html:!0,title:gg.widgets.passwordTooltip().content(n)}),n.on("show.bs.tooltip",function(){s(n),n.parent().find("span.error").hide()}).on("hidden.bs.tooltip",function(){s(n),n.parent().find("span.error").show()})})},content:function(e){var t,n;return null===r&&(a=$(e),n=a.data("tooltip-content"),r=$("<div>").addClass("help-block").append(n),(t=a).keyup(function(){i(t)}).change(function(){i(t)}).focus(function(){i(t)})),r}}},gg.controller.passwordTooltip=function(){return{init:function(e){return void 0!==gg.widgets.passwordTooltip&&gg.widgets.passwordTooltip().init(e),this}}};var showConnectingToPaypalOnload,managePasswordTooltip=(new gg.controller.passwordTooltip).init(window.tooltipOptions);(gg=gg||{}).controllers=gg.controllers||{},gg.controllers.basket=function(){return{get:function(e){},set:function(e,t){},remove:function(e){}}},$(document).ready(function(){gg.controllers.basket()}),function(e,n){var a=$("form#paypalForm"),t=$("form#savedPaypalForm"),r={show:!0,backdrop:"static",keyboard:!1},i='<div id="modalPaypalLoading" class="modal fade hide" tabindex="-1" role="dialog" aria-labelledby="modalPriceLabel"\n     aria-hidden="true">\n    <div class="modal-body">\n        <div class="center">\n            <p style="font-size: larger;">Connecting to PayPal securely....</p>\n            <i class="icon-15x15-loading  center"></i>\n            <br>\n        </div>\n    </div>\n</div>';function o(e){var a=$("<form>").attr("action",e.action).attr("method","post");return $.each(e.params,function(e,t){var n=$("<input>").attr("type","hidden").attr("name",e).attr("value",t);a.append(n)}),$(document.body).append(a),a}showConnectingToPaypalOnload=function(e){o(JSON.parse(e)).submit()},t.on("submit",function(e){e.preventDefault(),t.valid()&&(0<t.find("#altruisticTopUp").length?$(i).modal(r):$('<div id="modalSavedPaypalLoading" class="modal fade hide" tabindex="-1" role="dialog" aria-labelledby="modalPriceLabel"\n     aria-hidden="true">\n    <div class="modal-body">\n        <div class="center">\n            <p style="font-size: larger;">Completing PayPal payment....</p>\n            <i class="icon-15x15-loading  center"></i>\n            <br>\n        </div>\n    </div>\n</div>').modal(r))}),e?$('input[type="submit"]',a).on("click",function(e){if(e.preventDefault(),$(i).modal(r),a.valid()){spinner();var t=a.attr("action");$.ajax({url:t,method:"POST",type:"POST",data:a.serialize(),dataType:"json",success:function(e){o(e).submit()},error:function(){location.href=n},statusCode:{401:function(){location.reload()}}})}}):a.on("submit",function(e){e.preventDefault(),a.valid()&&$(i).modal(r)})}(1==window["adyen-paypal"],window["adyen-paypal-error"]),$(document).ready(function(){void 0!==window["connect-to-paypal-on-load"]&&"true"===window["connect-to-paypal-on-load"]&&showConnectingToPaypalOnload(window["connect-to-paypal-form-data"])}),gg.controllers.simActivation=function(e,t){"use strict";return e.activateSim=function(e){t.ajax({type:"GET",url:gg.baseUrl+e.nextUrl,dataType:"json",error:function(){window.location.href=baseUrl},success:function(e){console.log("response",e),e.hasSimProvisioned?window.location.href="/"+e.nextUrl:window.location.href=baseUrl},complete:function(e){e.abort()}})},e}(gg.controllers.simActivation||{},jQuery,messenger),gg.controllers.simActivation=function(e,t){"use strict";var a=function(){return t(".goodybags-list .choose-goodybag").map(function(e,t){var n=r(t);return n.brand="giffgaff",n.category="goodybags",n.position=e+1,n.list="activation",n})},r=function(e){return{id:t(e).data("sku"),name:t(e).data("product"),price:t(e).data("price")/100}},i=function(e){window.sessionCamRecorder&&window.sessionCamRecorder.createVirtualPageLoad&&window.sessionCamRecorder.createVirtualPageLoad(e)};return e.pushSavedTracking=function(){t("#products-pre-collapsed-section").is(":visible")?window.dataLayer.push({event:"plan",ecommerce:{checkout:{actionField:{step:3}},impressions:a()}}):t("#topup-pre-collapsed-section").is(":visible")?window.dataLayer.push({event:"topup",ecommerce:{checkout:{actionField:{option:"topup"}}}}):t("#payment-pre-collapsed-section").is(":visible")&&window.dataLayer.push({event:"cardDetails",ecommerce:{checkout:{actionField:{step:4}}}})},e.addTracking=function(e,t){if("1"==t)e?e.preSelectedBundle?window.dataLayer.push({event:"preSelected",preselectedGoodyBag:e.preSelectedBundle}):e.preLoadedBundleDetails?dataLayer.push({event:"welcome",pageview:gg.baseUrl+"welcome/"+e.trackingName}):e.prePaidSim&&(gg.isPrePaidSimActivation=!0,window.dataLayer.push({event:"prePaid"})):window.dataLayer.push({event:"activate",ecommerce:{checkout:{actionField:{step:1}}}});else if("2"==t)gg.isPrePaidSimActivation&&window.dataLayer.push({event:"prePaid"}),e.login?window.dataLayer.push({event:"login",ecommerce:{checkout:{actionField:{step:2}}}}):window.dataLayer.push({event:"register",ecommerce:{checkout:{actionField:{step:2}}}});else if("3"==t)i("/plans"),window.dataLayer.push({event:"plan",ecommerce:{checkout:{actionField:{step:3}},impressions:a()}});else if("4"==t){if(i("/payment"),e.topup)window.dataLayer.push({event:"topup",ecommerce:{checkout:{actionField:{option:"topup"}}}});else{var n=r(e);n.variant=""+n.price,n.quantity=1,window.dataLayer.push({event:"eeAddToBasket",eventCategory:"AddtoBasket",eventAction:n.name,ecommerce:{currencyCode:"GBP",actionField:{list:"activation"},add:{products:[n]}}})}window.dataLayer.push({event:"cardDetails",ecommerce:{checkout:{actionField:{step:4}}}})}else window.dataLayer.push(e)},e.addMgmTracking=function(){dataLayer.push({category:"MGM activation",Action:"min spend not reached"})},e.addConsentTracking=function(e){dataLayer.push(e)},e.addAuthenticationTracking=function(e){e?dataLayer.push({event:"customEvent",eventCategory:"NetworkAuth",eventAction:"Authorised"}):dataLayer.push({event:"customEvent",eventCategory:"Errors",eventAction:"FailedAuth",eventLabel:"**Napa Error Message Tag**"})},e.addCaptchaTracking=function(){dataLayer.push({event:"customEvent",eventCategory:"Errors",eventAction:"Click",eventLabel:"Five failures"})},e}(gg.controllers.simActivation||{},jQuery),gg.controllers.simActivation=function(e,r){"use strict";return e.animate=function(e,t,n){r("html, body").stop(!0,!1);var a=r("#"+e.attr("id"));0<r(a).length&&r("html, body").stop().animate({scrollTop:a.offset().top+20-n},t,"easeInOutSine")},e}(gg.controllers.simActivation||{},jQuery),gg.controllers.simActivation=function(a,r){"use strict";return a.bundleSelection=function(){gg.accordionSectionsContainer.on("click",".choose-goodybag",function(e){var t,n;return e.preventDefault(),t=r(this),n=t.data("product"),r.ajax({type:"GET",url:gg.baseUrl+"validate-products?goodybagUrl="+n,dataType:"JSON",beforeSend:function(){a.spinCta(t)},error:function(e){console.log(e),window.location.href=gg.baseUrl},success:function(e){if(!e.skipFunnel&&!e.sessionExpired)return e.addMgmTracking&&a.addMgmTracking(),a.addTracking(t,"4"),a.tickCta(t),a.loadSection(t,e.nextUrl,null,e),!1;window.location.href=gg.baseUrl},complete:function(e){e.abort()}}),!1})},a}(gg.controllers.simActivation||{},jQuery,messenger),gg.controllers.simActivation=function(r,i){"use strict";return r.editSelection=function(){gg.accordionSectionsContainer.on("click",".edit-selection",function(e){var t,n,a;return e.preventDefault(),t=i(this),n=t.closest("[class^='accordion-section']"),a=t.data("action"),n.nextAll().hide(),r.removeCheckoutCta(t),n.find(gg.accordionPostCollapsedSectionClassStr).hide(),a&&r.loadSection(t,t.data("action"),null,null),0<i(window).height()-n.height()&&n.css("padding-bottom",i(window).height()-n.height()+"px"),a||n.find(gg.accordionPreCollapsedSectionClassStr).fadeIn(500),r.animate(n,0,0),!1})},r}(gg.controllers.simActivation||{},jQuery),gg.controllers.simActivation=function(n,a){"use strict";return n.jumpTo=function(){gg.accordionSectionsContainer.on("click",".jump-to",function(e){var t;return e.preventDefault(),t=a(this),n.loadSection(t,t.data("next-section"),null,null),!1})},n}(gg.controllers.simActivation||{},jQuery,messenger),gg.controllers.simActivation=function(a,r){"use strict";return a.loadLoginForm=function(e,t){!function(e,t){e.parents("[class^='accordion-section']");var n=a.findDivByClass("login-form");a.resetLoginOptions(),gg.isPrePaidSimActivation&&a.forceLoginOnly(),n.show(),window.tooltipOptions&&"manual"==window.tooltipOptions.trigger&&r("#password1").tooltip("show"),t&&a.animate(n,gg.defaultAnimationWait,50)}(e,t)},a}(gg.controllers.simActivation||{},jQuery),gg.controllers.simActivation=function(p,f){"use strict";var r=function(e,t,n,a){var r=t&&t.postCollapseDivMsg?t.postCollapseDivMsg:null,i=t&&t.prevSectionPostCollapseDivMsg?t.prevSectionPostCollapseDivMsg:null,o=t.nextUrl+"-section",s=(o=gg.accordionSectionsContainer.find("."+o),e.data("action"),e.data("skip-section")||gg.activateFirstContainer.is(":visible")),d=e.parents("[class^='accordion-section']"),l=d.prev(".accordion-section"),c=l.find(gg.accordionPostCollapsedSectionClassStr),u=d.find(gg.accordionPostCollapsedSectionClassStr),g=o.find(gg.accordionPreCollapsedSectionClassStr);a&&v(t),p.managePaymentOptions(t);var h,m=r;a?(0<f("#activation-accordion").find("#messenger").length&&f("#payment").find("#messenger").remove(),o.find("#payment-details").html(n)):g.html(n);m&&(h=m,e.parents("[class^='accordion-']").find(gg.accordionPostCollapsedSectionClassStr).find(".post-content").html(h),i&&(l.find(".pre-collapsed-section").hide(),l.show(),c.show(),l.find(".post-content").html(i))),s?(d.removeClass("active"),d.hide(),p.animate(d,0,0),o.find(".post-collapsed-section").hide(),g.show(),o.fadeIn(gg.defaultAnimationWait)):(d.css("padding-bottom",f(window).height()+"px"),d.find(".pre-collapsed-section").hide(),d.find("a.edit-selection").addClass("not-active"),p.animate(d,5,0),d.promise().done(function(){u.fadeIn(gg.defaultAnimationWait)}),u.promise().done(function(){d.removeAttr("style","padding-bottom"),d.fadeIn()}),o.find(".post-collapsed-section").fadeOut(),g.fadeIn(),o.delay(300).fadeIn(500),o.promise().done(function(){0<f(window).height()-o.height()&&o.css("padding-bottom",f(window).height()-o.height()+"px"),d.find(".edit-selection").removeClass("not-active")})),t.preSelectedBundle?(gg.accordionProductSection.css("padding-bottom",""),p.animate(f("#products"),gg.defaultAnimationWait,0)):o.promise().done(function(){p.animate(o,gg.defaultAnimationWait,0)}),gg.widgets.customTooltip().init()},v=function(e){var t=f("#activation-accordion"),n=t.find("#payment_form"),a=t.find("#activate_redeem_voucher"),r=gg.cardForm,i=gg.storedCardForm;0<gg.storedCardForm.length&&gg.storedCardForm[0].reset(),0<gg.cardForm.length&&gg.cardForm[0].reset(),n.find('input[name="card_number"]').val("").keyup(),t.find("#new-card-payment").show(),t.find("#stored-card-payment").hide(),f("#payment_form input").each(function(){f(this).removeClass("error")}),f("span.error").remove(),gg.intnlCombobox.removeClass("error"),f("select#address-selector").hide(),f("span.address-selected").addClass("hide"),f(gg.addressTextClassStr).show(),f(gg.addressGroupClassStr).show();try{t.find("#payment_form #card_save_details");null!=(e=e.savedDetails)&&(e.personal_address&&(e.personal_address.line1,e.personal_address.isInternational?(d(n,"internationalPersonalAddress",e,"personal_address"),d(n,"internationalSavedCardPersonalAddress",e,"personal_address"),d(a,"voucherIntnlPersonalAddress",e,"personal_address")):(d(n,"ukBillingAddress",e,"personal_address"),d(n,"personalAddress",e,"personal_address"),d(a,"voucherUkPersonalAddress",e,"personal_address"))),e.billing_address&&(e.billing_address.line1,e.stored_card_info&&s(e.stored_card_info),e.billing_address.isInternational?(d(n,"internationalcardBillingAddress",e,"billing_address"),d(n,"internationalSavedcardBillingAddress",e,"billing_address"),d(a,"voucherIntnlPersonalAddress",e,"billing_address")):(d(n,"ukBillingAddress",e,"billing_address"),d(n,"personalAddress",e,"billing_address"),d(n,"savedCardBillingAddress",e,"billing_address"),d(n,"savedCardPersonalAddress",e,"billing_address"),d(a,"voucherUkPersonalAddress",e,"billing_address"))),e.stored_paypal_info?n.find("#paypal-email").html(e.stored_paypal_info):e.stored_card_info&&s(e.stored_card_info),i.data("requires-cvc",e.requiresSecurityCode),i.trigger("adyencvc"),f("#card_number").focus(),n.find('input[name="firstname"]').val(e.firstname),n.find('input[name="lastname"]').val(e.lastname),gg.defaultShippingCountry=e.shipping_country),o(r),o(i),e&&e&&e.billing_address&&e.personal_address||t.find(".country-dropdown").each(function(){f(this).val(gg.defaultCountry)}),gg.widgets.changeAddress().init()}catch(e){}},o=function(e){e.find("input.personal-address-check").click(),e.find("input.personal-address-check").attr("checked",!0)},s=function(e){gg.storedCardForm.find(".saved-card-form-info").html(e)},d=function(e,t,n,a){var r=e.find('input[name="'+t+'postcode"]').parents(".address-group"),i=r.prev(".saved-address").show();r.hide(),i.html(n["short_"+a]),e.find('input[name="'+t+'buildingNum"]').val(n[a].buildingNum),e.find('input[name="'+t+'buildingName"]').val(n[a].buildingName),e.find('input[name="'+t+'abodeNumber"]').val(n[a].abodeNumber),e.find('input[name="'+t+'locality"]').val(n[a].locality),e.find('input[name="'+t+'street"]').val(n[a].street),e.find('input[name="'+t+'line1"]').val(n[a].line1),e.find('input[name="'+t+'line2"]').val(n[a].line2),e.find('input[name="'+t+'city"]').val(n[a].city),e.find('input[name="'+t+'state"]').val(n[a].state),e.find('input[name="'+t+'postcode"]').val(n[a].postcode),e.find('input[name="country"]').val(n[a].country),function(e,t,n){e.find(".country-dropdown").parents(".control-group"),n=n&&null!=n?n:gg.defaultCountry,t=t&&null!=t?t:gg.defaultCountryCode;e.find(".country-dropdown").val(n)}(r,n[a].country,n[a].countryName),l(r,n[a].country),r.hide()},l=function(e,t){var n=gg.widgets.countryAddressSelector();t&&t!=gg.defaultCountryCode?(n.toggleInputs(e.find(gg.ukAddressClassStr),!1),n.toggleInputs(e.find(gg.intlAddressClassStr),!0)):(n.toggleInputs(e.find(gg.ukAddressClassStr),!0),n.toggleInputs(e.find(gg.intlAddressClassStr),!1))};return p.loadSection=function(e,t,n,a){!function(t,e,n,a){(a=a||{}).nextUrl=null!=e?e:a.nextUrl;a.nextUrl,n=n?"?"+n:"";f(".top-section-header").hide(),f.ajax({type:"GET",url:gg.baseUrl+a.nextUrl+n,dataType:"html",error:function(){window.location.href=gg.baseUrl},success:function(e){r(t,a,e,"payment-details"==a.nextUrl)},complete:function(e){p.focusFirstVisibleInput(),e.abort()}})}(e,t,n,a)},p}(gg.controllers.simActivation||{},jQuery,messenger),gg.controllers.simActivation=function(o,s){"use strict";var t=function(e,t){var n=t.closest("form")[0],a=s(n.nickname),r=s(n).serialize(),i=t.data("next-section");if(s(n).valid())return s.ajax({type:"POST",url:n.action,cache:!1,dataType:"json",data:r,error:function(e){console.log(e),window.location.href=gg.baseUrl},beforeSend:function(){o.spinCta(t)},success:function(e){if(e.consentTracking&&window.dataLayer.push(e.consentTracking),e.sessionExpired)window.location.href=gg.baseUrl+"?error=Registration_Session_Timeout";else if(e.error)if("LS_PROCESS_IN_PROGRESS"===e.errorCode)window.location.href=gg.baseUrl+"?error=Lost_And_Stolen_In_Progress";else{if("invalid-register"===e.error)s("#signup").validate().showErrors(e.errors);else"invalid-register-token"===e.error&&(window.location.href=gg.baseUrl+"?error=Registration_Session_Timeout");a.is(":visible")?a.after("<span class = 'error'>"+e.msg+"</span>"):s(n.password).after("<span class = 'error'>"+e.msg+"</span>"),o.showErrors(),o.removeCheckoutCta(t)}else e.skipFunnel?window.location.href=gg.baseUrl+e.nextUrl:(o.tickCta(t),"voucher-section"==i?o.loadVoucherForm(t,e.postCollapseDivMsg):"activate-unprovisioned-sim"==e.nextUrl?o.activateSim(e):(o.loadSection(t,e.nextUrl,null,e),"payment-details"!=e.nextUrl?o.addTracking(e,"3"):e.preSelectedBundle&&(o.addTracking(e,"3"),o.addTracking(e,"4"))))},complete:function(){t.off()}}),!1;o.showErrors()};return o.loginOrRegister=function(){gg.accordionSectionsContainer.on("click","#activateLogin",function(e){return e.preventDefault(),o.addTracking({login:!0},"2"),t(0,s(this)),!1}),gg.accordionSectionsContainer.on("click","#activateRegister",function(e){return e.preventDefault(),t(0,s(this)),!1})},o}(gg.controllers.simActivation||{},jQuery),gg.controllers.simActivation=function(e,t){"use strict";return e.mgmTopup=function(){gg.accordionSectionsContainer.on("click","#mgm-extra-topup",function(e){return e.preventDefault(),gg.paymentCardForms.show(),gg.paymentPayPalForms.show(),gg.paymentMgmTopupForm.show(),gg.paymentMgmTopupSelectors.hide(),gg.cardForm.find('input[name="topup"]').val(),!1}),gg.accordionSectionsContainer.on("click","#"+gg.paymentMgmTopupForm.attr("id")+" .topup-amount",function(e){gg.cardForm.find('input[name="mgm_topup"]').val(t(this).data("amount")),gg.paypalForm.find('input[name="mgm_topup"]').val(t(this).data("amount")),gg.storedCardForm.find('input[name="mgm_topup"]').val(t(this).data("amount"))})},e}(gg.controllers.simActivation||{},jQuery),gg.controllers.simActivation=function(e,n){"use strict";return e.paymentOptions=function(){n("input[name='payment_method']").change(function(){var e=n(this).val();n(".tab-pane").removeClass("active"),n("#"+e+"-tab-content").addClass("active")})},e.managePaymentOptions=function(e){gg.paymentTabs.removeClass("two-tabs");var t=e.savedDetails||{};null!=t&&(t.stored_paypal_info?(n("#payment_form #card").hide(),n("#card-tab-content").hide(),n("#paypal-tab-content").addClass("active"),gg.paymentCardTab.removeClass("active"),n("#payment_form #paypal").show(),n("#payment_form #saved-paypal").show(),gg.paymentTabs.addClass("two-tabs"),gg.paymentPaypalTab.addClass("active")):t.stored_card_info&&(gg.paymentCardTabContent.addClass("active"),gg.paymentCardTab.addClass("active"),n("#new-card-payment").hide(),gg.paymentPaypalTabContent.removeClass("active"),gg.paymentPaypalTab.removeClass("active"),gg.paymentTabs.addClass("two-tabs"),n("#payment_form .stored-card-payment").show())),e.preSelectedBundle&&(gg.paymentVoucherTab.addClass("active"),gg.paymentTabs.removeClass("two-tabs")),(e.bundleActivation||e.savedBasketPreSelectedDetails&&e.savedBasketPreSelectedDetails.goodybagDetails)&&(e.savedBasketPreSelectedDetails&&e.savedBasketPreSelectedDetails.goodybagDetails&&(n("#products").show(),n("#products .post-collapsed-section").show(),n("#products .pre-collapsed-section").hide(),n("#products").find(".post-content").html(e.savedBasketPreSelectedDetails.goodybagDetails)),gg.paymentBundleContent.show(),gg.paymentListContainer.show(),gg.paymentPreLoadedContent.hide(),gg.paymentTopupContent.hide(),gg.paymentVoucherTab.removeClass("active"),gg.paymentVoucherTab.show(),gg.paymentCardTab.show(),gg.paymentPaypalTab.show(),gg.paymentCardTab.addClass("active"),gg.paymentCardTab.find(":input").prop("checked",!0),gg.paymentPaypalTab.removeClass("active"),gg.paymentPaypalTabContent.removeClass("active"),gg.paymentVoucherTabContent.removeClass("active"),gg.paymentCardTabContent.addClass("active"),gg.paymentTabsContainer.show(),gg.paymentTabs.show(),e.isMinMgmOrder?(gg.paymentCardForms.hide(),gg.paymentPayPalForms.hide(),gg.paymentBundleContent.hide(),gg.paymentMgmTopup.show(),gg.paymentMgmTopupSelectors.show(),gg.paymentMgmTopupForm.hide()):(gg.paymentCardForms.show(),gg.paymentPayPalForms.show(),gg.paymentMgmTopup.hide(),gg.paymentBundleContent.show()),t&&(t.stored_card_info||t.stored_paypal_info)&&(n(".payment-options-sub-header").hide(),n("#new-card-payment").hide(),n("#new-paypal").hide(),gg.paymentBundleContent.hide(),gg.paymentVoucherTab.show()),t.stored_paypal_info?(gg.paymentCardTab.hide(),gg.paymentCardTab.removeClass("active"),gg.paymentPaypalTab.addClass("active"),gg.paymentPaypalTabContent.addClass("active"),gg.paymentPaypalTab.find(":input").prop("checked",!0)):t.stored_card_info&&(gg.paymentTabs.addClass("two-tabs"),gg.paymentCardTab.addClass("active"),gg.paymentPaypalTab.hide(),gg.paymentPaypalTab.removeClass("active"),gg.paymentCardTabContent.addClass("active"))),e.topupActivation&&(gg.paymentTabsContainer.show(),gg.paymentListContainer.show(),gg.paymentTabs.show(),gg.paymentBundleContent.hide(),gg.paymentTopupContent.show(),gg.paymentVoucherTab.removeClass("active"),gg.paymentPaypalTab.removeClass("active"),gg.paymentPaypalTabContent.removeClass("active"),gg.paymentCardTab.addClass("active"),gg.paymentVoucherTab.hide(),gg.paymentVoucherTabContent.removeClass("active"),gg.paymentCardForms.show(),gg.paymentPayPalForms.show(),gg.paymentCardTabContent.addClass("active"),gg.paymentMgmTopup.hide(),gg.paymentTabs.addClass("two-tabs"),gg.paymentCardTab.find(":input").prop("checked",!0),t.stored_paypal_info?(gg.paymentCardTab.hide(),gg.paymentPaypalTab.show(),gg.paymentPaypalTabContent.addClass("active"),gg.paymentPaypalTab.find(":input").prop("checked",!0)):t.stored_card_info&&(gg.paymentCardTab.show(),gg.paymentPaypalTab.hide(),gg.paymentCardTabContent.addClass("active")),t&&(t.stored_card_info||t.stored_paypal_info)&&(gg.paymentTabs.remove("two-tabs"),n(".payment-options-sub-header").hide(),n("#new-card-payment").hide(),n("#new-paypal").hide(),gg.paymentTabsContainer.hide())),e.voucherActivation&&(gg.paymentTabsContainer.hide(),gg.paymentListContainer.hide(),gg.paymentBundleContent.hide(),gg.paymentBundleContent.hide(),gg.paymentPreLoadedContent.hide(),gg.paymentTopupContent.hide(),gg.paymentVoucherTab.addClass("active"),gg.paymentCardTab.removeClass("active"),gg.paymentPaypalTab.removeClass("active"),gg.paymentVoucherTabContent.addClass("active"),gg.paymentCardTabContent.removeClass("active"),gg.paymentPaypalTabContent.removeClass("active"),gg.paymentCardForms.hide(),gg.paymentPayPalForms.hide()),e.preLoadedActivation&&(gg.paymentTabsContainer.show(),gg.preloadedBundleContent.show(),gg.paymentListContainer.show(),gg.paymentCardTab.addClass("active"),gg.paymentCardTabContent.addClass("active"),gg.paymentBundleContent.hide(),gg.paymentTopupContent.hide(),gg.paymentVoucherTab.hide())},e}(gg.controllers.simActivation||{},jQuery),gg.controllers.simActivation=function(n,a){"use strict";return n.preLoadedSimActivation=function(){gg.accordionSectionsContainer.on("click","#preloaded-sim-continue-login",function(e){var t;return e.preventDefault(),t=a(this),a.ajax({type:"GET",url:gg.baseUrl+"pre-loaded-sim-next-steps",cache:!1,dataType:"json",error:function(){window.location.href=gg.baseUrl},beforeSend:function(){n.spinCta(t)},success:function(e){gg.isPreLoadedSimActivation=!0,a("#payment-options-sub-header").hide(),a("#activation-order-payment").val(e.ctaLabel),"login"==e.nextUrl?(a(".login-form").fadeIn(),n.animate(a(".login-form"),gg.defaultAnimationWait,30)):"payment-details"==e.nextUrl?n.loadSection(t,e.nextUrl,null,e):"activate-unprovisioned-sim"==e.nextUrl&&n.activateSim(e),spinner(),n.tickCta(t)},complete:function(e){e.abort()}}),!1})},n}(gg.controllers.simActivation||{},jQuery,messenger),gg.controllers.simActivation=function(o,s){"use strict";var d=s("#notice-errors");o.simCodeEntry=function(){gg.accordionSectionsContainer.on("click",gg.activateCodeButton,function(e){return s(this).unbind(),e.preventDefault(),function(e,t){var n=gg.baseUrl+"validate-sim-code?code=",a=t.closest("form")[0],r=s(a.code),i=t.data("next-section");if(d.remove(),s(a).valid())return s.ajax({type:"GET",url:n+r.val().toUpperCase()+"&next-action="+i,cache:!1,dataType:"json",error:function(){window.location.href=gg.baseUrl},beforeSend:function(){o.spinCta(t),r.blur()},success:function(e){e.error?(o.removeCheckoutCta(t),r.removeAttr("disabled"),r.after("<span class = 'error'>"+e.msg+"</span>")):(l(e,!0),e.error||o.tickCta(t)),spinner()},complete:function(e){o.focusFirstVisibleInput(),t.off(),e.abort()}});r.removeAttr("disabled"),o.showErrors()}(0,s(this)),!1})};var l=function(e,t){var n=gg.activateCodeForm;n.find("#code");try{e.skipFunnel?window.location.href=gg.baseUrl+e.nextUrl:e.max_tries_exceeded&&0<s(".g-recaptcha").length?(grecaptcha.execute(),event.stopPropagation(),o.addCaptchaTracking()):(o.hideOrShowFaqs("hide"),gg.activationType=e.code,gg.hasPromoCampaign=e.campaignPromo,gg.isPrePaidSimActivation=!!e.prePaidSim&&e.prePaidSim,o.addTracking(e,"1"),e.preLoadedBundleDetails?(gg.preloadedBundleSection.show(),gg.preloadedBundleSection.find(".bundle-details").html(e.preLoadedBundleDetails),t&&o.animate(gg.preloadedBundleSection,gg.defaultAnimationWait,30)):"login"==e.nextUrl?(o.loadLoginForm(n,t),o.addTracking(e,"2")):o.loadSection(n,e.nextUrl,null,e))}catch(e){window.location.href=gg.baseUrl}s(gg.LoadingImage).hide()};return o.autoValidateSim=function(){var e,t=gg.activateCodeForm,n=t.data("auto-validation-response"),a=(e=new RegExp("[?&amp;]"+"msisdn"+"=([^&amp;#]*)").exec(window.location.href))?e[1]:0;n&&(t.removeAttr("data-auto-validation-response"),l(n,!1)),a&&o.addAuthenticationTracking(n)},o}(gg.controllers.simActivation||{},jQuery),gg.controllers.simActivation=function(e,t){"use strict";return e.startOver=function(){gg.activateCodeForm[0].reset(),gg.activateCodeForm[0].code.disabled=!1,t.each(document.querySelectorAll("button.submit-loading"),function(){t(this).hide(),t(this).prev('input[type="submit"]').show()}),gg.preloadedBundleSection.hide(),gg.loginFormsContainer.hide(),t(".top-section-header").show(),gg.activateCodeContainer.show(),e.hideOrShowFaqs("show"),gg.activateFirstContainer.nextAll().hide(),gg.activateFirstContainer.find(".post-collapsed-section").hide(),gg.activateFirstContainer.show(),gg.activateFirstContainer.find(".pre-collapsed-section").show(),e.animate(gg.activateFirstContainer,0,0),t.ajax({url:"/basket?flow_name=activation",type:"DELETE"}),e.addTracking(null,"1")},e}(gg.controllers.simActivation||{},jQuery),gg.controllers.simActivation=function(e,l){"use strict";return e.toggleAddress=function(){gg.accordionSectionsContainer.on("click","input.personal-address-check",function(e){var t,n,a,r,i,o,s,d;t=l(this).parents("form"),n=l(this),a=t.find(".personal-address"),r="GBR"!=a.find(".country-selector").val(),i=a.find(".address-group"),o=n.is(":checked"),s=i.find(".ukAddress"),d=i.find(".internationalAddress"),o?(a.slideUp("slow").fadeOut("1000"),i.find(":input").attr("disabled","disabled")):(i.find(".country-dropdown").removeAttr("disabled"),a.slideDown("slow").fadeIn("1000"),r?d.find(":input").removeAttr("disabled"):s.find(":input").removeAttr("disabled"))})},e}(gg.controllers.simActivation||{},jQuery),gg.controllers.simActivation=function(a,r){"use strict";return a.toggleRecurrence=function(){r("#postActivationBundleRecurrence").on("change",function(e){!function(e){var t=!1;e.is(":checked")&&(t=!0);var n=e.data("bundle-sku");a.addTracking({event:"customEvent",eventCategory:"Auto Recur",eventAction:"click"}),r.ajax({type:"POST",url:gg.baseUrl+"toggle-reccurence?enableRecurence="+t+"&bundleSku="+n,dataType:"JSON",beforeSend:function(){r(".instant-success-message").hide(),r(".toggle-recur-error").hide(),r("#toggle-recurrence .icon-15x15-loading").remove(),r(".toggle-recurrence-disabled-msg").hide(),r(".toggle-recurrence-enabled-msg").hide(),r(".toggle-recurrence-msg").hide().after("<i class='icon-15x15-loading'></i>"),spinner()},error:function(){r("#postActivationBundleRecurrence").attr("checked",!t),r(".instant-success-message").hide(),r(".toggle-recur-error").show()},success:function(e){t?(r(".toggle-recurrence-disabled-msg").fadeOut(),r(".toggle-recurrence-enabled-msg").fadeIn()):(r(".toggle-recurrence-disabled-msg").fadeIn(),r(".toggle-recurrence-enabled-msg").fadeOut()),r(".instant-success-message").fadeIn().animate({opacity:1},1500).fadeOut("slow")},complete:function(e){r(".icon-15x15-loading").remove(),e.abort()}})}(r(this))})},a}(gg.controllers.simActivation||{},jQuery),gg.controllers.simActivation=function(n,a){"use strict";return n.topup=function(){gg.accordionSectionsContainer.on("click","#activate-topup-amount #submitButton",function(e){return e.preventDefault(),function(t){t.closest("form")[0];var e=a(".topup_amounts").find(".active").find(".topup-amount").data("amount");a.ajax({type:"POST",url:gg.baseUrl+"validate-topup?clearGb=true&topup="+e,dataType:"JSON",beforeSend:function(){n.spinCta(t)},error:function(){window.location.href=gg.baseUrl},success:function(e){e.skipFunnel||e.sessionExpired?window.location.href=gg.baseUrl:(n.addTracking({topup:!0},"4"),n.tickCta(t),n.loadSection(t,e.nextUrl,null,e))},complete:function(e){e.abort()}})}(a(this)),!1}),gg.accordionSectionsContainer.on("click","#choose-voucher",function(e){var t;return e.preventDefault(),t=a(this),a.ajax({type:"POST",url:gg.baseUrl+"validate-topup?clearGb=true&topup=0",dataType:"JSON",error:function(){window.location.href=gg.baseUrl},success:function(e){e.skipFunnel||e.sessionExpired?window.location.href=gg.baseUrl:n.loadSection(t,e.nextUrl,null,e)},complete:function(e){e.abort()}}),!1})},n}(gg.controllers.simActivation||{},jQuery,messenger),gg.controllers.simActivation=function(e,r){"use strict";return e.updateRecommenderDetails=function(){r("#activation-success-page").on("click","#submit-recommender-details",function(e){var t,n,a;return e.preventDefault(),t=r(this),n=t.closest("form")[0],a=r(n.recommendermsisdn).val(),r(n).valid()&&r.ajax({type:"POST",url:n.action+"&recommenderMobileNumber="+a,cache:!1,dataType:"json",success:function(e){},complete:function(){r("#recommend-friend-section").hide(),r("#recommendation-success-section").fadeIn()}}),!1})},e}(gg.controllers.simActivation||{},jQuery),gg.controllers.simActivation=function(a,r){"use strict";var i=function(e,t){var n=e.find(":input");return t?(n.removeAttr("disabled"),n.removeClass("ignore"),e.show()):(n.attr("disabled","disabled"),n.addClass("ignore"),e.hide()),e};return a.validatePayment=function(){gg.accordionSectionsContainer.on("click","#activation-order-payment, #savedCardPayment",function(e){return e.preventDefault(),function(e){var t=e.parents("form");if(1==r(t).find("input.personal-address-check").is(":checked")){var n=r(t).find(".personal-address");i(n.find(gg.ukAddressClassStr),!1),i(n.find(gg.intlAddressClassStr),!1)}if(r(t).valid())try{t.submit(),spinCta(e),gg.defaultShippingCountry!=gg.defaultCountry&&a.addTracking({event:"customEvent",eventCategory:"International Activation",eventAction:"click",eventLabel:gg.defaultShippingCountry})}catch(e){}else a.showErrors()}(r(this)),!1})},a}(gg.controllers.simActivation||{},jQuery),gg.controllers.variables=function(e,t){"use strict";return e.init=function(){gg.baseUrl="/activate/",gg.isPrePaidSimActivation=!1,gg.defaultCountry="United Kingdom",gg.defaultCountryCode="GBR",gg.defaultShippingCountry=gg.defaultCountry,gg.defaultAnimationWait=750,gg.activateFirstContainer=t("#activate"),gg.activateCodeContainer=t(".sim-code-container"),gg.loginFormsContainer=t("#login-form"),gg.activateCodeForm=t("#activate-code-form"),gg.activateCodeButton="#submit-activate",gg.LoadingImage=".loading-image",gg.ukAddressClassStr=".ukAddress",gg.intlAddressClassStr=".internationalAddress",gg.addressGroupClassStr=".address-group",gg.addressTextClassStr=".saved-address",gg.intnlCombobox=t(".intl-combobox-wrap"),gg.accordionSectionsContainer=t("#activation-accordion"),gg.accordionPostCollapsedSectionClassStr=".post-collapsed-section",gg.accordionPreCollapsedSectionClassStr=".pre-collapsed-section",gg.accordionEditSelectionClassStr=".edit-selection",gg.accordionProductSection=t("#products"),gg.accordionPaymentSection=t("#payment"),gg.preloadedBundleSection=t(".pre-loaded-bundle-section"),gg.preloadedBundleContent=t(".pre-loaded-bundle-content"),gg.paymentTabsContainer=t(".payment-tabs-container"),gg.paymentListContainer=t(".payment-list-container"),gg.paymentBundleContent=t(".bundle-payment-content"),gg.paymentTopupContent=t(".topup-payment-content"),gg.paymentPreLoadedContent=t(".pre-loaded-bundle-content"),gg.paymentVoucherTab=t("#voucher-tab"),gg.paymentCardTab=t("#card-tab"),gg.paymentPaypalTab=t("#paypal-tab"),gg.paymentTabs=t("#payment-tabs"),gg.paymentVoucherTabContent=t("#voucher-tab-content"),gg.paymentCardTabContent=t("#card-tab-content"),gg.paymentPaypalTabContent=t("#paypal-tab-content"),gg.paymentCardForms=t("#card-forms"),gg.paymentPayPalForms=t("#paypal-forms"),gg.cardForm=t("#card_payment"),gg.storedCardForm=t("#stored_card"),gg.paypalForm=t("#paypalForm"),gg.storedPaypalForm=t("#stored_card"),gg.paymentMgmTopup=t(".mgm-topup"),gg.paymentMgmTopupSelectors=t(".mgm-extra-topup-selectors"),gg.paymentMgmTopupForm=t(".mgm-topup-form")},e}(gg.controllers.variables||{},jQuery),(gg=gg||{}).controllers.simActivation=function(n,a){n.focusFirstVisibleInput=function(){var e=a("input:visible:enabled","form:visible")[0];a(e).focus()},n.resetLoginOptions=function(){a(".login-options").show(),a(".nav-two-tabbed").show(),a("#login-form").find("#login").removeClass("offset4"),a("#activate-login-form #loginForm")[0].reset(),a("#activate-signup-form #signup")[0].reset(),a("#activate-signup-form i.icon-15x15-success").remove(),a("#activate-signup-form #emailConfirm div").html("")},n.showAllLinks=function(e){e.parents("[class^='accordion-']")},n.forceLoginOnly=function(){loginForm=a("#login-form"),a("#activate-login-form").show(),loginForm.find("#login").addClass("offset4"),loginForm.find(".content-nav-bar").hide(),a("#activate-signup-form").hide(),a(".login-options").hide()},n.showErrors=function(){0<a(".error").length&&a("html, body").animate({scrollTop:a(".error").offset().top-100},100,"easeInOutSine")},n.hideOrShowFaqs=function(e){"hide"==e?a("#section-faqs").fadeOut():a("#section-faqs").fadeIn()},n.findDivByClass=function(e){return a(".activation-accordion").find("."+e)},n.removeCheckoutCta=function(e){var t=e.closest("[class^='accordion-section']").find(".btn-accrodion-checkout");e.show(),t.removeClass("btn-accrodion-checkout"),t.html(""),t.hide(),e.closest("[class^='accordion-section']").find(".accordion-cta").show()},n.removeErrorMessage=function(){0<a("#activation-accordion").find("#messenger").length&&(a(".voucher-section").find("#messenger").remove(),a("#payment").find("#messenger").remove())},n.tickCta=function(e){var t=e.next();(t.show(),t.html("<i class='icon-24x24cards-tick-green'  style= 'display:inline-block'></i>"),e.hasClass("activate-sim"))&&(e.closest("form")[0].code.disabled=!0)},n.spinCta=function(e){var t=e.hide().next();t.html("<i class='icon-15x15-loading'></i>"),t.addClass("btn-accrodion-checkout"),t.show(),spinner()};n.focusFirstVisibleInput=function(){var e=a("input:visible:enabled","form:visible")[0];a(e).focus()};moveToLastActiveSection=function(){var e=a("#activation-accordion-container div.accordion-section.active:last");e.is(":first-child")?(a(".accordion-messages").show(),n.focusFirstVisibleInput()):(e.prepend(a(".accordion-messages").show()),n.animate(e,0,20)),a("#modalSkipCardSave").show(),n.pushSavedTracking()};var t=function(){var e=a("#activation-accordion-container div.accordion-section:visible:last"),t=a("#"+e.attr("id")).prevAll(".accordion-section:visible");e.is(":first-child")?window.location.href="/":0==t.length?n.startOver():(e.hide(),t.promise().done(function(){t.find(".edit-selection").click()}))};return n.init=function(){moveToLastActiveSection(),function(){if("function"==typeof history.pushState)history.pushState("activation",null,null),window.onpopstate=function(e){null!=e.state&&(t(),history.pushState("newactivation",null,null))};else{var e=!0;window.onhashchange=function(){e?e=!1:(e=!0,window.location.hash=Math.random())}}}(),n.pushSavedTracking(),n.simCodeEntry(),n.loginOrRegister(),n.bundleSelection(),n.voucherSelection(),n.topup(),n.mgmTopup(),n.validatePayment(),n.editSelection(),n.jumpTo(),n.toggleAddress(),n.preLoadedSimActivation(),n.toggleRecurrence(),n.updateRecommenderDetails(),n.paymentOptions(),gg.widgets.countryAddressSelector(),n.autoValidateSim(),a("#activation-accordion-container").on("hover click",".always-on-tooltip",function(e){e.preventDefault(),a(".always-on-tooltip").next("div.tooltip:visible").length<=0&&a(".always-on-tooltip").tooltip("show")}).mouseout(".always-on-tooltip",function(){0<a(".always-on-tooltip").next("div.tooltip:visible").length&&a(".always-on-tooltip").tooltip("hide")}),a("#change_card").live("click",function(e){e.preventDefault();var t=a("#activation-accordion");t.find("#stored-card-payment").fadeOut(),t.find("#new-card-payment").fadeIn("fast"),n.animate(a("#payment_form"),0,0)}),a(".activate-switch-forms").click(function(e){e.preventDefault(),a("#activate-login-form").is(":visible")?(a("#activate-signup-form").fadeIn("500"),a("#activate-login-form-selectors").fadeIn("500"),a("#activate-signup-form-selectors").hide(),a("#activate-login-form").hide()):(a("#activate-login-form").fadeIn("500"),a("#activate-signup-form-selectors").fadeIn("500"),a("#activate-signup-form").hide(),a("#activate-login-form-selectors").hide()),n.focusFirstVisibleInput()})},n}(gg.controllers.simActivation||{},jQuery),$(document).ready(function(){gg.controllers.variables.init(),gg.controllers.simActivation.init(),gg.widgets.postCodeLabelFixer().init()});var gg,simcode_recaptcha=simcode_recaptcha||{};if(simcode_recaptcha.controller||(simcode_recaptcha.controller={}),!simcode_recaptcha.controller.verifyCaptcha){function onVerifyCaptcha(){gg.activateCodeContainer.show();var e=gg.activateCodeForm;e.find("#code").removeAttr("disabled"),e.find("#code").val(""),e.find(".btn-accrodion-checkout").hide(),$(gg.activateCodeButton).show(),e.find("#code").after("<span class = 'error'>Sorry, that isn't a valid Activation code. Please check and try again</span>"),grecaptcha.reset(),event.stopPropagation()}simcode_recaptcha.controller.verifyCaptcha={}}gg.controllers.simActivation=function(e,t){"use strict";return e.voucherSelection=function(){gg.accordionSectionsContainer.on("click","#choose-voucher",function(e){return e.preventDefault(),t("#voucher-tab").trigger("click"),t("#voucher-tab-content").addClass("active"),t("#card-tab-content").removeClass("active"),t(".payment-tabs-container").hide(),t("#payment-tabs").hide(),t(".bundle-payment-content").hide(),t(".pre-loaded-bundle-section").hide(),t(".topup-payment-content").hide(),!1})},e}(gg.controllers.simActivation||{},jQuery,messenger),(gg=gg||{}).controllers=gg.controllers||{},gg.controllers.creditCardController=function(){var e=["card_payload","cvc_payload"];function n(e,t){e.unbind("submit"),e.submit(function(e){e.preventDefault();var t,n,a,r,i,o=$(this),s=$(o).find('input[type="submit"]');if((t=s.hide().next()).html("<i class='icon-15x15-loading'></i>"),t.addClass("btn-accrodion-checkout"),t.show(),spinner(),o.validate(),o.valid()){var d=o.find("input");$.when((n=d,a=function(e){var t=$(e).find('[name="non-submission-elements"]');if(t.length){var n=t.data("non-submission-elements");if(null!=n)return n.split(",")}return[]}(o),r=$.Deferred(),i=n.length,n.each(function(e){var t=$(this).attr("name");"undefined"!==t&&-1<$.inArray(t,a)&&$(this).attr("disabled","disabled"),e==i-1&&r.resolve(!0)}),i<1&&r.resolve(!1),r.promise())).then(function(e){o.unbind("submit").submit()})}else!function(e){e.show();var t=e.next("button");t.hide(),t.html("")}(s)})}return{init:function(){e.forEach(function(e){var t=$("#"+e);n($(t).closest("form"))})}}},$(document).ready(function(){void 0!==window["remove-cc-from-submission"]&&"true"===window["remove-cc-from-submission"]&&gg.controllers.creditCardController().init()}),(gg=gg||{}).controllers=gg.controllers||{},gg.controllers.upsell=function(){return{storeTopupUpsellOption:function(e){var t=$(e),n=t.data("storeUpsellChoiceUrl"),a=t.is(":checked");$.post(n,{topupUpsell:a})}}};